<!DOCTYPE html>
<!-- saved from url=(0053)http://127.0.0.1:7026/Final_Project_Final_Version.Rmd -->
<html class=""><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  
  <script type="application/shiny-singletons"></script>
  <script type="application/html-dependencies">jquery[3.6.0];shiny-css[1.7.3];shiny-javascript[1.7.3]</script>
<script src="./Final_Project_Final_Version_files/jquery.min.js.download"></script>
<link href="./Final_Project_Final_Version_files/shiny.min.css" rel="stylesheet">
<script src="./Final_Project_Final_Version_files/shiny.min.js.download"></script>  <script src="./Final_Project_Final_Version_files/rmd_loader.js.download"></script>
  <link href="./Final_Project_Final_Version_files/rmd_loader.css" rel="stylesheet">
<style data-styled="active" data-styled-version="5.3.6"></style><script src="./Final_Project_Final_Version_files/header-attrs.js.download"></script><meta name="viewport" content="width=device-width, initial-scale=1"><link href="./Final_Project_Final_Version_files/bootstrap.min.css" rel="stylesheet" type="text/css"><script src="./Final_Project_Final_Version_files/bootstrap.min.js.download"></script><script src="./Final_Project_Final_Version_files/html5shiv.min.js.download"></script><script src="./Final_Project_Final_Version_files/respond.min.js.download"></script><style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style><script src="./Final_Project_Final_Version_files/tabsets.js.download"></script><link href="./Final_Project_Final_Version_files/default.css" rel="stylesheet" type="text/css"><script src="./Final_Project_Final_Version_files/highlight.js.download"></script><link href="./Final_Project_Final_Version_files/pagedtable.css" rel="stylesheet" type="text/css"><script src="./Final_Project_Final_Version_files/pagedtable.js.download"></script><script src="./Final_Project_Final_Version_files/ion.rangeSlider.min.js.download"></script><script src="./Final_Project_Final_Version_files/strftime-min.js.download"></script><link href="./Final_Project_Final_Version_files/ion.rangeSlider.css" rel="stylesheet" type="text/css"><link href="./Final_Project_Final_Version_files/selectize.bootstrap3.css" rel="stylesheet" type="text/css"><script src="./Final_Project_Final_Version_files/selectize.min.js.download"></script><script src="./Final_Project_Final_Version_files/selectize-plugin-a11y.min.js.download"></script><link href="./Final_Project_Final_Version_files/rmd_perf.css" rel="stylesheet" type="text/css"><script src="./Final_Project_Final_Version_files/rmd_perf.js.download"></script><meta name="rstudio_origin" content="127.0.0.1:64695"><script src="./Final_Project_Final_Version_files/rsiframe.js.download"></script>


<meta name="generator" content="pandoc">
<meta http-equiv="X-UA-Compatible" content="IE=EDGE">


<meta name="author" content="prj-pcbarko-schen176–mettler3-yc62-gianghl2">

<meta name="date" content="2022-12-07">

<title>Predicting song popularity using pseudo-random sampling of spotify catalog</title>


<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type="text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>



<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




<script type="text/javascript" src="./Final_Project_Final_Version_files/MathJax.js.download"></script><style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Menu_Button .MathJax_Hover_Arrow {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 4px; -webkit-border-radius: 4px; -moz-border-radius: 4px; -khtml-border-radius: 4px; font-family: 'Courier New',Courier; font-size: 9px; color: #F0F0F0}
.MathJax_Menu_Button .MathJax_Hover_Arrow span {display: block; background-color: #AAA; border: 1px solid; border-radius: 3px; line-height: 0; padding: 4px}
.MathJax_Hover_Arrow:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_Hover_Arrow:hover span {background-color: #CCC!important}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_About.MathJax_MousePost {outline: none}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 2px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 2px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; padding-top: .25em; color: #666666; font-size: .75em}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: 1em}
.MathJax_MenuRadioCheck.RTL {right: 1em; left: auto}
.MathJax_MenuLabel {padding: 2px 2em 4px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #CCCCCC; margin: 4px 1px 0px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: Highlight; color: HighlightText}
.MathJax_MenuDisabled:focus, .MathJax_MenuLabel:focus {background-color: #E8E8E8}
.MathJax_ContextMenu:focus {outline: none}
.MathJax_ContextMenu .MathJax_MenuItem:focus {outline: none}
#MathJax_AboutClose {top: .2em; right: .2em}
.MathJax_Menu .MathJax_MenuClose {top: -10px; left: -10px}
.MathJax_MenuClose {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; font-family: 'Courier New',Courier; font-size: 24px; color: #F0F0F0}
.MathJax_MenuClose span {display: block; background-color: #AAA; border: 1.5px solid; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; line-height: 0; padding: 8px 0 6px}
.MathJax_MenuClose:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_MenuClose:hover span {background-color: #CCC!important}
.MathJax_MenuClose:hover:focus {outline: none}
</style><style type="text/css">.MathJax_Preview .MJXf-math {color: inherit!important}
</style><style type="text/css">.MJX_Assistive_MathML {position: absolute!important; top: 0; left: 0; clip: rect(1px, 1px, 1px, 1px); padding: 1px 0 0 0!important; border: 0!important; height: 1px!important; width: 1px!important; overflow: hidden!important; display: block!important; -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none}
.MJX_Assistive_MathML.MJX_Assistive_MathML_Block {width: 100%!important}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; -webkit-box-sizing: content-box; -moz-box-sizing: content-box; box-sizing: content-box; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1em; bottom: 1.5em; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><style type="text/css">.MJXp-script {font-size: .8em}
.MJXp-right {-webkit-transform-origin: right; -moz-transform-origin: right; -ms-transform-origin: right; -o-transform-origin: right; transform-origin: right}
.MJXp-bold {font-weight: bold}
.MJXp-italic {font-style: italic}
.MJXp-scr {font-family: MathJax_Script,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-frak {font-family: MathJax_Fraktur,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-sf {font-family: MathJax_SansSerif,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-cal {font-family: MathJax_Caligraphic,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-mono {font-family: MathJax_Typewriter,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-largeop {font-size: 150%}
.MJXp-largeop.MJXp-int {vertical-align: -.2em}
.MJXp-math {display: inline-block; line-height: 1.2; text-indent: 0; font-family: 'Times New Roman',Times,STIXGeneral,serif; white-space: nowrap; border-collapse: collapse}
.MJXp-display {display: block; text-align: center; margin: 1em 0}
.MJXp-math span {display: inline-block}
.MJXp-box {display: block!important; text-align: center}
.MJXp-box:after {content: " "}
.MJXp-rule {display: block!important; margin-top: .1em}
.MJXp-char {display: block!important}
.MJXp-mo {margin: 0 .15em}
.MJXp-mfrac {margin: 0 .125em; vertical-align: .25em}
.MJXp-denom {display: inline-table!important; width: 100%}
.MJXp-denom > * {display: table-row!important}
.MJXp-surd {vertical-align: top}
.MJXp-surd > * {display: block!important}
.MJXp-script-box > *  {display: table!important; height: 50%}
.MJXp-script-box > * > * {display: table-cell!important; vertical-align: top}
.MJXp-script-box > *:last-child > * {vertical-align: bottom}
.MJXp-script-box > * > * > * {display: block!important}
.MJXp-mphantom {visibility: hidden}
.MJXp-munderover, .MJXp-munder {display: inline-table!important}
.MJXp-over {display: inline-block!important; text-align: center}
.MJXp-over > * {display: block!important}
.MJXp-munderover > *, .MJXp-munder > * {display: table-row!important}
.MJXp-mtable {vertical-align: .25em; margin: 0 .125em}
.MJXp-mtable > * {display: inline-table!important; vertical-align: middle}
.MJXp-mtr {display: table-row!important}
.MJXp-mtd {display: table-cell!important; text-align: center; padding: .5em 0 0 .5em}
.MJXp-mtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-mlabeledtr {display: table-row!important}
.MJXp-mlabeledtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mlabeledtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MJXp-scale0 {-webkit-transform: scaleX(.0); -moz-transform: scaleX(.0); -ms-transform: scaleX(.0); -o-transform: scaleX(.0); transform: scaleX(.0)}
.MJXp-scale1 {-webkit-transform: scaleX(.1); -moz-transform: scaleX(.1); -ms-transform: scaleX(.1); -o-transform: scaleX(.1); transform: scaleX(.1)}
.MJXp-scale2 {-webkit-transform: scaleX(.2); -moz-transform: scaleX(.2); -ms-transform: scaleX(.2); -o-transform: scaleX(.2); transform: scaleX(.2)}
.MJXp-scale3 {-webkit-transform: scaleX(.3); -moz-transform: scaleX(.3); -ms-transform: scaleX(.3); -o-transform: scaleX(.3); transform: scaleX(.3)}
.MJXp-scale4 {-webkit-transform: scaleX(.4); -moz-transform: scaleX(.4); -ms-transform: scaleX(.4); -o-transform: scaleX(.4); transform: scaleX(.4)}
.MJXp-scale5 {-webkit-transform: scaleX(.5); -moz-transform: scaleX(.5); -ms-transform: scaleX(.5); -o-transform: scaleX(.5); transform: scaleX(.5)}
.MJXp-scale6 {-webkit-transform: scaleX(.6); -moz-transform: scaleX(.6); -ms-transform: scaleX(.6); -o-transform: scaleX(.6); transform: scaleX(.6)}
.MJXp-scale7 {-webkit-transform: scaleX(.7); -moz-transform: scaleX(.7); -ms-transform: scaleX(.7); -o-transform: scaleX(.7); transform: scaleX(.7)}
.MJXp-scale8 {-webkit-transform: scaleX(.8); -moz-transform: scaleX(.8); -ms-transform: scaleX(.8); -o-transform: scaleX(.8); transform: scaleX(.8)}
.MJXp-scale9 {-webkit-transform: scaleX(.9); -moz-transform: scaleX(.9); -ms-transform: scaleX(.9); -o-transform: scaleX(.9); transform: scaleX(.9)}
.MathJax_PHTML .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><style type="text/css">.MathJax_Display {text-align: center; margin: 1em 0em; position: relative; display: block!important; text-indent: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; width: 100%}
.MathJax .merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MathJax .MJX-monospace {font-family: monospace}
.MathJax .MJX-sans-serif {font-family: sans-serif}
#MathJax_Tooltip {background-color: InfoBackground; color: InfoText; border: 1px solid black; box-shadow: 2px 2px 5px #AAAAAA; -webkit-box-shadow: 2px 2px 5px #AAAAAA; -moz-box-shadow: 2px 2px 5px #AAAAAA; -khtml-box-shadow: 2px 2px 5px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true'); padding: 3px 4px; z-index: 401; position: absolute; left: 0; top: 0; width: auto; height: auto; display: none}
.MathJax {display: inline; font-style: normal; font-weight: normal; line-height: normal; font-size: 100%; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; padding: 0; margin: 0}
.MathJax:focus, body :focus .MathJax {display: inline-table}
.MathJax.MathJax_FullWidth {text-align: center; display: table-cell!important; width: 10000em!important}
.MathJax img, .MathJax nobr, .MathJax a {border: 0; padding: 0; margin: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; vertical-align: 0; line-height: normal; text-decoration: none}
img.MathJax_strut {border: 0!important; padding: 0!important; margin: 0!important; vertical-align: 0!important}
.MathJax span {display: inline; position: static; border: 0; padding: 0; margin: 0; vertical-align: 0; line-height: normal; text-decoration: none; box-sizing: content-box}
.MathJax nobr {white-space: nowrap!important}
.MathJax img {display: inline!important; float: none!important}
.MathJax * {transition: none; -webkit-transition: none; -moz-transition: none; -ms-transition: none; -o-transition: none}
.MathJax_Processing {visibility: hidden; position: fixed; width: 0; height: 0; overflow: hidden}
.MathJax_Processed {display: none!important}
.MathJax_test {font-style: normal; font-weight: normal; font-size: 100%; font-size-adjust: none; text-indent: 0; text-transform: none; letter-spacing: normal; word-spacing: normal; overflow: hidden; height: 1px}
.MathJax_test.mjx-test-display {display: table!important}
.MathJax_test.mjx-test-inline {display: inline!important; margin-right: -1px}
.MathJax_test.mjx-test-default {display: block!important; clear: both}
.MathJax_ex_box {display: inline-block!important; position: absolute; overflow: hidden; min-height: 0; max-height: none; padding: 0; border: 0; margin: 0; width: 1px; height: 60ex}
.MathJax_em_box {display: inline-block!important; position: absolute; overflow: hidden; min-height: 0; max-height: none; padding: 0; border: 0; margin: 0; width: 1px; height: 60em}
.mjx-test-inline .MathJax_left_box {display: inline-block; width: 0; float: left}
.mjx-test-inline .MathJax_right_box {display: inline-block; width: 0; float: right}
.mjx-test-display .MathJax_right_box {display: table-cell!important; width: 10000em!important; min-width: 0; max-width: none; padding: 0; border: 0; margin: 0}
.MathJax .MathJax_HitBox {cursor: text; background: white; opacity: 0; filter: alpha(opacity=0)}
.MathJax .MathJax_HitBox * {filter: none; opacity: 1; background: transparent}
#MathJax_Tooltip * {filter: none; opacity: 1; background: transparent}
@font-face {font-family: MathJax_Main; src: url('http://127.0.0.1:7026/mathjax-local/fonts/HTML-CSS/TeX/woff/MathJax_Main-Regular.woff?V=2.7.6') format('woff'), url('http://127.0.0.1:7026/mathjax-local/fonts/HTML-CSS/TeX/otf/MathJax_Main-Regular.otf?V=2.7.6') format('opentype')}
@font-face {font-family: MathJax_Main-bold; src: url('http://127.0.0.1:7026/mathjax-local/fonts/HTML-CSS/TeX/woff/MathJax_Main-Bold.woff?V=2.7.6') format('woff'), url('http://127.0.0.1:7026/mathjax-local/fonts/HTML-CSS/TeX/otf/MathJax_Main-Bold.otf?V=2.7.6') format('opentype')}
@font-face {font-family: MathJax_Main-italic; src: url('http://127.0.0.1:7026/mathjax-local/fonts/HTML-CSS/TeX/woff/MathJax_Main-Italic.woff?V=2.7.6') format('woff'), url('http://127.0.0.1:7026/mathjax-local/fonts/HTML-CSS/TeX/otf/MathJax_Main-Italic.otf?V=2.7.6') format('opentype')}
@font-face {font-family: MathJax_Math-italic; src: url('http://127.0.0.1:7026/mathjax-local/fonts/HTML-CSS/TeX/woff/MathJax_Math-Italic.woff?V=2.7.6') format('woff'), url('http://127.0.0.1:7026/mathjax-local/fonts/HTML-CSS/TeX/otf/MathJax_Math-Italic.otf?V=2.7.6') format('opentype')}
@font-face {font-family: MathJax_Caligraphic; src: url('http://127.0.0.1:7026/mathjax-local/fonts/HTML-CSS/TeX/woff/MathJax_Caligraphic-Regular.woff?V=2.7.6') format('woff'), url('http://127.0.0.1:7026/mathjax-local/fonts/HTML-CSS/TeX/otf/MathJax_Caligraphic-Regular.otf?V=2.7.6') format('opentype')}
@font-face {font-family: MathJax_Size1; src: url('http://127.0.0.1:7026/mathjax-local/fonts/HTML-CSS/TeX/woff/MathJax_Size1-Regular.woff?V=2.7.6') format('woff'), url('http://127.0.0.1:7026/mathjax-local/fonts/HTML-CSS/TeX/otf/MathJax_Size1-Regular.otf?V=2.7.6') format('opentype')}
@font-face {font-family: MathJax_Size2; src: url('http://127.0.0.1:7026/mathjax-local/fonts/HTML-CSS/TeX/woff/MathJax_Size2-Regular.woff?V=2.7.6') format('woff'), url('http://127.0.0.1:7026/mathjax-local/fonts/HTML-CSS/TeX/otf/MathJax_Size2-Regular.otf?V=2.7.6') format('opentype')}
@font-face {font-family: MathJax_Size3; src: url('http://127.0.0.1:7026/mathjax-local/fonts/HTML-CSS/TeX/woff/MathJax_Size3-Regular.woff?V=2.7.6') format('woff'), url('http://127.0.0.1:7026/mathjax-local/fonts/HTML-CSS/TeX/otf/MathJax_Size3-Regular.otf?V=2.7.6') format('opentype')}
@font-face {font-family: MathJax_Size4; src: url('http://127.0.0.1:7026/mathjax-local/fonts/HTML-CSS/TeX/woff/MathJax_Size4-Regular.woff?V=2.7.6') format('woff'), url('http://127.0.0.1:7026/mathjax-local/fonts/HTML-CSS/TeX/otf/MathJax_Size4-Regular.otf?V=2.7.6') format('opentype')}
.MathJax .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style></head>
<body><div style="visibility: hidden; overflow: hidden; position: absolute; top: 0px; height: 1px; width: auto; padding: 0px; border: 0px; margin: 0px; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal;"><div id="MathJax_Hidden"></div></div><div id="MathJax_Message" style="display: none;"></div>
  <div>
    <div data-display-if="!output.__reactivedoc__" data-ns-prefix="" style="display: none;">
      <div id="rmd_loader_wrapper">
        <div id="rmd_loader" style="">
          <p>Please wait...</p>
          <img src="./Final_Project_Final_Version_files/rmd_loader.gif">
        </div>
      </div>
    </div>
    <div id="__reactivedoc__" class="shiny-html-output shiny-bound-output" aria-live="polite">








<div class="container-fluid main-container">




<div id="section-header">



<h1 class="title toc-ignore">Predicting song popularity using
pseudo-random sampling of spotify catalog</h1>
<h4 class="author">prj-pcbarko-schen176–mettler3-yc62-gianghl2</h4>
<h4 class="date">2022-12-07</h4>

</div>


<div id="section-abstract" class="section level1">
<h1>Abstract</h1>
<p>Spotify is an audio streaming service used by hundreds of millions of
people. The popularity of Spotify songs is described by a popularity
index and each song is associated with features that quantify various
sonic attributes (e.g.&nbsp;pitch, danceability, etc.). For this group
project, we sought to generate statistical models that can predict the
popularity of a song based on these sonic attributes. We constructed a
Spotify songs database using custom R and Python scripts to query the
Spotify API and appended it to a similar, publicly available database.
Song popularity was predicted using several models, whose performance
was compared.</p>
</div>
<div id="section-introduction" class="section level1">
<h1>Introduction</h1>
<p><a href="https://open.spotify.com/">Spotify</a> is a web-based audio
streaming service, first launched in 2008, with 456 million users,
including 195 million subscribers across 183 markets. The popularity of
each song is quantified using a numeric popularity index from 0-100.
Each song is also associated with metadata including genre, artist, and
several attributes that describe various acoustic/sonic features:</p>
<ul>
<li>acousticness</li>
<li>danceability</li>
<li>durations</li>
<li>energy</li>
<li>instrumentalness</li>
<li>key</li>
<li>liveness</li>
<li>loudness</li>
<li>mode</li>
<li>speechiness</li>
<li>tempo</li>
<li>valence</li>
</ul>
<p>We sought to model the song popularity index using the acoustic
attributes in a large database of Spotify songs. There are several
publicly available Spotify song datasets, but these are outdated.
Additionally, we sought to develop a novel means of accessing song data
from the Spotify API.</p>
<p>Our <em>fist objective</em> was to create a new, updated dataset of
Spotify songs. We attempted to accomplish this by generating random song
IDs and using these to search the Spotify API.</p>
<p>Our <em>second objective</em> was to model song popularity (dependent
variable) from the acoustic attributes (independet variables). Others
have attempted to model popularity from the acoustic attributes and
genre, but most used linear models that had poor performance. For this
project, we utilized alternative approaches to modeling/predicting song
popularity from acoustic attributes and compared them with respect to
performance.</p>
<div id="section-sampling-techniques" class="section level2">
<h2>Sampling Techniques</h2>
<div id="section-issues-generating-random-sample" class="section level3">
<h3>Issues generating random sample</h3>
<p>Randomly sampling the spotify catalog is a difficult task that is
beyond the timeframe and computing power available to our cohort.
Spotify randomly assigns each music track a twenty one character id. The
first character is always numeric but the remaining characters are case
sensitive alphanumeric characters with repetition. Thus, we have a
sample space of <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-1-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mn&gt;62&lt;/mn&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;20&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;10&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1" style="width: 5.241em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.348em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.134em, 1004.23em, 2.622em, -999.997em); top: -2.199em; left: 0em;"><span class="mrow" id="MathJax-Span-2"><span class="mo" id="MathJax-Span-3" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-4"><span style="display: inline-block; position: relative; width: 1.789em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.96em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="mn" id="MathJax-Span-5" style="font-family: MathJax_Main;">62</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.402em; left: 1.015em;"><span class="texatom" id="MathJax-Span-6"><span class="mrow" id="MathJax-Span-7"><span class="mn" id="MathJax-Span-8" style="font-size: 70.7%; font-family: MathJax_Main;">20</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-9" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-10" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-11" style="font-family: MathJax_Main;">10</span><span class="mo" id="MathJax-Span-12" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.504em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><msup><mn>62</mn><mrow class="MJX-TeXAtom-ORD"><mn>20</mn></mrow></msup><mo stretchy="false">)</mo><mo stretchy="false">(</mo><mn>10</mn><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-1">(62^{20})(10)</script></span> but
the actual sample space of spotify tracks is a much smaller subset of
the total sample space (approximately <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-2-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mn&gt;1.41&lt;/mn&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;28&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-13" style="width: 3.753em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.098em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.074em, 1003.1em, 2.324em, -999.997em); top: -2.14em; left: 0em;"><span class="mrow" id="MathJax-Span-14"><span class="msubsup" id="MathJax-Span-15"><span style="display: inline-block; position: relative; width: 3.098em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1001.73em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="mn" id="MathJax-Span-16" style="font-family: MathJax_Main;">1.41</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.402em; left: 1.789em;"><span class="texatom" id="MathJax-Span-17"><span class="mrow" id="MathJax-Span-18"><span class="mo" id="MathJax-Span-19" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-20" style="font-size: 70.7%; font-family: MathJax_Main;">28</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.218em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mn>1.41</mn><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mn>28</mn></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-2">1.41^{-28}</script></span> of the sample space). Below we
implemented the stringi package to generate random id’s that are then
pulled from Spotify’s api using the Spotifyr package. Unfortunately, due
to the time it would take to generate a random sample this way and that
the spotify API limits the number of inquiries a developer can make we
would not be able to generate a sample this way.</p>
<pre class="r"><code class="hljs"><span class="hljs-comment"># generates 21 character long IDs that were used to query the API</span>
spot_id_track_check &lt;- <span class="hljs-keyword">function</span>(x) get_tracks(x)

spot_ids &lt;- <span class="hljs-keyword">function</span>(Length) {

    st_int &lt;- stri_rand_strings(<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-string">"[0-9]"</span>)
    st_char &lt;- stri_rand_strings(as.integer(Length), <span class="hljs-number">21</span>, pattern = <span class="hljs-string">"[A-Za-z0-9]"</span>)
    spot_id &lt;- seq(st_int)
    <span class="hljs-keyword">for</span> (i <span class="hljs-keyword">in</span> spot_id) {
        spot_id[i] &lt;- paste(st_int[i], st_char[i], sep = <span class="hljs-string">""</span>)
    }

    xt &lt;- do.call(c, replicate(n = Length, mclapply(spot_id, <span class="hljs-keyword">function</span>(x) {
        spot_id_track_check(x)
    }, mc.cores = <span class="hljs-number">48</span>)))
    <span class="hljs-keyword">return</span>(xt)
}

songs &lt;- spot_ids(<span class="hljs-string">"1000"</span>)

<span class="hljs-comment"># this does not return any valid song data because of the large sample space</span>
songs</code></pre>
<p>Without the ability to draw a sample from randomly generating string
id’s, We decided to use the function <em>search_spotify</em> to return
tracks from randomly generated strings that the function uses to search
for matches with track id’s. For instance, if we use a generated string
<em>“abd”</em> then tracks that include these characters in the title
will be returned from the search. Additionally, we used a vector of each
upper/lower case and number to return tracks that match each character.
This sampling method is effective but has some drawbacks. The search
function is a subset of all Spotify tracks. When iterating over
characters we are likely to get repeat tracks if we draw a large enough
sampling. Thus, not all tracks are able to be sampled and the sample
size we can actually draw is limited to several hundred thousand tracks.
Below are several examples of pseudo random samples using shell script,
R, and Python.</p>
<div style="page-break-after: always;"></div>
</div>
<div id="section-bash-sampling-script" class="section level3">
<h3>Bash sampling script</h3>
<pre class="bash"><code class="hljs">
<span class="hljs-meta">#!/bin/bash</span>
<span class="hljs-comment"># Bash script to search for random ids for Spotify tracks using the web API.</span>
<span class="hljs-comment"># Usage: bash spotify_scraping.sh $CLIENT_ID $CLIENT_SECRET</span>

CLIENT_ID=<span class="hljs-variable">$1</span>
CLIENT_SECRET=<span class="hljs-variable">$2</span>

creds=<span class="hljs-variable">$CLIENT_ID</span>:<span class="hljs-variable">$CLIENT_SECRET</span>
encoded_creds=$(<span class="hljs-built_in">echo</span> -n <span class="hljs-variable">$creds</span> | base64)

access_token=$(curl -s -X <span class="hljs-string">"POST"</span> -H <span class="hljs-string">"Authorization: Basic <span class="hljs-variable">$encoded_creds</span>"</span> -d grant_type=client_credentials https://accounts.spotify.com/api/token | awk -F<span class="hljs-string">"\""</span> <span class="hljs-string">'{print $4}'</span>)
<span class="hljs-built_in">echo</span> <span class="hljs-variable">$access_token</span>
rm result.json extracted_ids.txt

<span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> {a..z}
<span class="hljs-keyword">do</span>
<span class="hljs-keyword">for</span> y <span class="hljs-keyword">in</span> {0..9}
<span class="hljs-keyword">do</span>
curl --request GET --url <span class="hljs-string">"https://api.spotify.com/v1/search?q=<span class="hljs-variable">$x</span><span class="hljs-variable">$y</span>&amp;type=track&amp;limit=50&amp;year=1970-2023"</span> --header <span class="hljs-string">"Authorization: Bearer <span class="hljs-variable">$access_token</span>"</span> --header <span class="hljs-string">"Content-Type: application/json"</span> &gt;&gt; result.json
<span class="hljs-keyword">done</span>
<span class="hljs-keyword">done</span>
cat result.json | grep -o <span class="hljs-string">"\"id\" :.*"</span> | sed <span class="hljs-string">'s/"id" : "//g'</span> | sed <span class="hljs-string">'s/",$//g'</span> &gt;&gt; extracted_ids.txt
cat extracted_ids.txt | sort | uniq &gt; tmp
mv tmp extracted_ids.txt <span class="hljs-comment">## extract id's to use in R spotifyr package</span>

<span class="hljs-comment">#### use R package to gain audio track features using R spotify package</span>
Sys.setenv(SPOTIFY_CLIENT_ID = <span class="hljs-string">''</span>)
Sys.setenv(SPOTIFY_CLIENT_SECRET = <span class="hljs-string">''</span>)

access_token &lt;- get_spotify_access_token()

setwd(<span class="hljs-string">"/Users/gianghale/Documents/GitHub/fa22-prj-pcbarko-schen176--mettler3-yc62-gianghl2/Old_Data"</span>)
ids &lt;- read.table(<span class="hljs-string">"extracted_ids.txt"</span>)
ids &lt;- apply(ids, MARGIN=1,FUN=toString)
ids_list &lt;- as.list(strsplit(ids, <span class="hljs-string">" "</span>))

<span class="hljs-comment"># write track audio features to csv</span>
lapply(ids_list, <span class="hljs-keyword">function</span>(x) write.table(get_track_audio_features(x), <span class="hljs-string">'track_features_25k.csv'</span>, append=TRUE,col.names = FALSE, sep=<span class="hljs-string">','</span> ))
</code></pre>
<p>R function below makes use of the Spotifyr, parallel, and stringi
packages to generate track id’s from Spotify’s API. The track id’s are
then used in Spotifyr’s <em>get_track_audio_features</em> to return the
audio features we will use to predict popularity.</p>
</div>
<div id="section-r-sampling-script" class="section level3">
<h3>R sampling script</h3>
<pre class="r"><code class="hljs">Sys.setenv(SPOTIFY_CLIENT_ID = <span class="hljs-string">""</span>)
Sys.setenv(SPOTIFY_CLIENT_SECRET = <span class="hljs-string">""</span>)


<span class="hljs-comment"># function ran inside mylist function to get audio features of sampled tracks</span>
spot_id_track_check &lt;- <span class="hljs-keyword">function</span>(x) get_track_audio_features(x)

mylist &lt;- <span class="hljs-keyword">function</span>(x) {
    xL &lt;- c()
    st_char &lt;- stri_rand_strings(<span class="hljs-number">2</span>, x, pattern = <span class="hljs-string">"[A-Za-z0-9]"</span>)  <span class="hljs-comment">## generate random strings to match and return from Spotify API</span>
    xL &lt;- foreach(i = st_char) %do% {
        <span class="hljs-comment"># search track returns tracks from spotify API</span>
        search_spotify(i, type = <span class="hljs-string">"track"</span>, market = <span class="hljs-literal">NULL</span>, limit = <span class="hljs-number">50</span>, offset = <span class="hljs-number">0</span>,
            include_external = <span class="hljs-literal">NULL</span>, include_meta_info = <span class="hljs-literal">FALSE</span>)

    }
    xt &lt;- xL
    <span class="hljs-comment"># bind</span>
    sp_s &lt;- bind_rows(xt, .id = <span class="hljs-string">"column_label"</span>)
    x_id &lt;- sp_s$id
    <span class="hljs-comment">## get audio track features</span>
    sp_f &lt;- spot_id_track_check(x_id)
    sp_s &lt;- sp_s[-c(<span class="hljs-number">1</span>, <span class="hljs-number">3</span>, <span class="hljs-number">17</span>, <span class="hljs-number">18</span>, <span class="hljs-number">21</span>)]
    artists &lt;- do.call(cbind.data.frame, lapply(sp_s, <span class="hljs-keyword">function</span>(x) {
        <span class="hljs-comment"># check if list</span>
        <span class="hljs-keyword">if</span> (is.list(x)) {
            data.frame(t(sapply(x, <span class="hljs-string">"["</span>, seq(max(lengths(x))))))
        } <span class="hljs-keyword">else</span> {
            x
        }
    }))

    spot_data &lt;- cbind(artists, sp_f)

    <span class="hljs-comment">## return two dataframes,track information and audio features</span>
    <span class="hljs-keyword">return</span>(spot_data)
}


<span class="hljs-comment">### Replicate function to get large dataset of spotify tracks</span>
x &lt;- replicate(n = <span class="hljs-number">2</span>, mclapply(<span class="hljs-number">3</span>, <span class="hljs-keyword">function</span>(x) {
    mylist(x)
}, mc.cores = <span class="hljs-number">48</span>))

x1 &lt;- bind_rows(x, .id = <span class="hljs-string">"column_label"</span>)

<span class="hljs-comment"># Including only wanted parameters</span>
sp_all_unique &lt;- x1[, c(<span class="hljs-number">12</span>, <span class="hljs-number">14</span>, <span class="hljs-number">4</span>, <span class="hljs-number">22</span>, <span class="hljs-number">23</span>, <span class="hljs-number">24</span>, <span class="hljs-number">15</span>, <span class="hljs-number">32</span>, <span class="hljs-number">33</span>, <span class="hljs-number">34</span>, <span class="hljs-number">35</span>, <span class="hljs-number">36</span>, <span class="hljs-number">37</span>, <span class="hljs-number">38</span>, <span class="hljs-number">39</span>,
    <span class="hljs-number">40</span>, <span class="hljs-number">41</span>, <span class="hljs-number">42</span>, <span class="hljs-number">9</span>)]


<span class="hljs-comment">## remove duplicates</span>
sp_all_unique &lt;- sp_all_unique[!duplicated(sp_all_unique[<span class="hljs-number">1</span>]), ]

sp_all_unique &lt;- sp_all_unique %&gt;%
    mutate(Popularity_Quantized = cut(popularity, breaks = c(<span class="hljs-number">0</span>, <span class="hljs-number">25</span>, <span class="hljs-number">50</span>, <span class="hljs-number">75</span>, <span class="hljs-number">100</span>),
        include.lowest = <span class="hljs-literal">TRUE</span>))

colnames(sp_all_unique) &lt;- c(<span class="hljs-string">"TrackID"</span>, <span class="hljs-string">"SongName"</span>, <span class="hljs-string">"Artist"</span>, <span class="hljs-string">"track_album_id"</span>, <span class="hljs-string">"Album_Name"</span>,
    <span class="hljs-string">"Release_Date"</span>, <span class="hljs-string">"Popularity"</span>, <span class="hljs-string">"Danceability"</span>, <span class="hljs-string">"Energy"</span>, <span class="hljs-string">"Key"</span>, <span class="hljs-string">"Loudness"</span>, <span class="hljs-string">"Mode"</span>,
    <span class="hljs-string">"Speachiness"</span>, <span class="hljs-string">"Acousticness"</span>, <span class="hljs-string">"Instrumentalness"</span>, <span class="hljs-string">"Liveness"</span>, <span class="hljs-string">"Valence"</span>, <span class="hljs-string">"Tempo"</span>,
    <span class="hljs-string">"Duration"</span>, <span class="hljs-string">"Popularity_Quantized"</span>)

<span class="hljs-comment"># sample of songs saved as songs.tsv</span>
write_tsv(sp_all_unique, <span class="hljs-string">"songs.tsv"</span>)</code></pre>
</div>
<div id="section-python-sampling-script" class="section level3">
<h3>Python sampling script</h3>
<pre class="python"><code class="hljs"><span class="hljs-comment"># Python script to sample tracks</span>

<span class="hljs-keyword">import</span> csv
<span class="hljs-keyword">import</span> itertools
<span class="hljs-keyword">import</span> string

<span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd
<span class="hljs-keyword">import</span> spotipy
<span class="hljs-keyword">from</span> spotipy.oauth2 <span class="hljs-keyword">import</span> SpotifyClientCredentials


<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CrawlerSpotify</span>:</span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span><span class="hljs-params">(self, client_id, client_secret)</span>:</span>
        <span class="hljs-comment"># authorization information</span>
        self.id = client_id
        self.secret = client_secret
        self.spotify = spotipy.Spotify(client_credentials_manager=
                                       SpotifyClientCredentials(client_id=self.id, client_secret=self.secret))

    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">save_tracks</span><span class="hljs-params">(self, output_path: str = None)</span>:</span>
        search_words = self._generate_search_words()  <span class="hljs-comment"># generate search words</span>

        results = []
        <span class="hljs-keyword">for</span> sq <span class="hljs-keyword">in</span> search_words:  <span class="hljs-comment"># iterate search words</span>
            search_results = self.spotify.search(q=sq, type=<span class="hljs-string">'track'</span>, limit=<span class="hljs-number">50</span>)
            total = search_results[<span class="hljs-string">'tracks'</span>][<span class="hljs-string">'total'</span>]
            print(<span class="hljs-string">f'===== A total of <span class="hljs-subst">{total}</span> results from search word: <span class="hljs-subst">{sq}</span> ====='</span>)

            <span class="hljs-keyword">for</span> offset <span class="hljs-keyword">in</span> range(<span class="hljs-number">0</span>, total <span class="hljs-keyword">if</span> total &lt; <span class="hljs-number">1000</span> <span class="hljs-keyword">else</span> <span class="hljs-number">1000</span>, <span class="hljs-number">50</span>):  <span class="hljs-comment"># iterate pages.</span>
                <span class="hljs-comment"># for each search word, the API returns 1000 results at most,</span>
                <span class="hljs-comment"># so we can get maximum 20 pages for each search word (50 tracks each page)</span>
                <span class="hljs-comment"># see https://developer.spotify.com/documentation/web-api/reference/#/operations/search</span>
                print(<span class="hljs-string">f'results from page <span class="hljs-subst">{int(offset / <span class="hljs-number">50</span> + <span class="hljs-number">1</span>)}</span>'</span>)
                tracks = self._parse_tracks(self.spotify.search(q=sq, type=<span class="hljs-string">'track'</span>, limit=<span class="hljs-number">50</span>, offset=offset))
                audio_features = self.spotify.audio_features([track[<span class="hljs-string">'track_id'</span>] <span class="hljs-keyword">for</span> track <span class="hljs-keyword">in</span> tracks])  <span class="hljs-comment"># audio features</span>
                result = [{**track, **self._parse_audio_features(audio_feature)} <span class="hljs-keyword">if</span> audio_feature <span class="hljs-keyword">else</span> track <span class="hljs-keyword">for</span>
                          track, audio_feature <span class="hljs-keyword">in</span>
                          zip(tracks, audio_features)]  <span class="hljs-comment"># combine track details and audio features</span>
                self._save_csv(result, output_path)  <span class="hljs-comment"># save to csv</span>
                results.append(result)

        <span class="hljs-keyword">return</span> pd.DataFrame(results)

<span class="hljs-meta">    @staticmethod</span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">_save_csv</span><span class="hljs-params">(result, output_path: str)</span>:</span>
        csv_header = [<span class="hljs-string">'track_id'</span>, <span class="hljs-string">'track_name'</span>, <span class="hljs-string">'track_artist'</span>, <span class="hljs-string">'track_popularity'</span>, <span class="hljs-string">'track_album_id'</span>,
                      <span class="hljs-string">'track_album_name'</span>, <span class="hljs-string">'track_album_release_date'</span>, <span class="hljs-string">'danceability'</span>, <span class="hljs-string">'energy'</span>, <span class="hljs-string">'key'</span>,
                      <span class="hljs-string">'loudness'</span>, <span class="hljs-string">'mode'</span>, <span class="hljs-string">'speechiness'</span>, <span class="hljs-string">'acousticness'</span>, <span class="hljs-string">'instrumentalness'</span>, <span class="hljs-string">'liveness'</span>,
                      <span class="hljs-string">'valence'</span>, <span class="hljs-string">'tempo'</span>, <span class="hljs-string">'duration_ms'</span>]

        <span class="hljs-keyword">with</span> open(output_path, <span class="hljs-string">'a'</span>, newline=<span class="hljs-string">''</span>, encoding=<span class="hljs-string">'utf-8-sig'</span>) <span class="hljs-keyword">as</span> fp:
            csv_writer = csv.DictWriter(fp, csv_header)
            <span class="hljs-keyword">if</span> fp.tell() == <span class="hljs-number">0</span>:
                csv_writer.writeheader()
            csv_writer.writerows(result)

<span class="hljs-meta">    @staticmethod</span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">_parse_tracks</span><span class="hljs-params">(search_results)</span>:</span>
        <span class="hljs-string">"""
        extract useful data from search results
        """</span>
        details = []
        <span class="hljs-keyword">for</span> track <span class="hljs-keyword">in</span> search_results[<span class="hljs-string">'tracks'</span>][<span class="hljs-string">'items'</span>]:
            details.append({
                <span class="hljs-string">'track_id'</span>: track[<span class="hljs-string">'id'</span>],
                <span class="hljs-string">'track_name'</span>: track[<span class="hljs-string">'name'</span>],
                <span class="hljs-string">'track_artist'</span>: track[<span class="hljs-string">'artists'</span>][<span class="hljs-number">0</span>][<span class="hljs-string">'name'</span>],
                <span class="hljs-string">'track_popularity'</span>: track[<span class="hljs-string">'popularity'</span>],
                <span class="hljs-string">'track_album_id'</span>: track[<span class="hljs-string">'album'</span>][<span class="hljs-string">'id'</span>],
                <span class="hljs-string">'track_album_name'</span>: track[<span class="hljs-string">'album'</span>][<span class="hljs-string">'name'</span>],
                <span class="hljs-string">'track_album_release_date'</span>: track[<span class="hljs-string">'album'</span>][<span class="hljs-string">'release_date'</span>]
            })
        <span class="hljs-keyword">return</span> details

<span class="hljs-meta">    @staticmethod</span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">_parse_audio_features</span><span class="hljs-params">(audio_feature_results)</span>:</span>
        <span class="hljs-string">"""
        delete unnecessary data from audio feature results
        """</span>
        del_key = [<span class="hljs-string">'type'</span>, <span class="hljs-string">'uri'</span>, <span class="hljs-string">'track_href'</span>, <span class="hljs-string">'analysis_url'</span>, <span class="hljs-string">'time_signature'</span>, <span class="hljs-string">'id'</span>]
        <span class="hljs-keyword">return</span> {key: audio_feature_results[key] <span class="hljs-keyword">for</span> key <span class="hljs-keyword">in</span> audio_feature_results <span class="hljs-keyword">if</span> key <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> del_key}

<span class="hljs-meta">    @staticmethod</span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">_generate_search_words</span><span class="hljs-params">()</span>:</span>
        <span class="hljs-string">"""
        generate search words. from letters a-z and numbers 0-9, with years 1985-2022
        """</span>
        search_words = []
        <span class="hljs-keyword">for</span> word, year <span class="hljs-keyword">in</span> itertools.product(list(string.ascii_lowercase) + list(range(<span class="hljs-number">0</span>, <span class="hljs-number">10</span>)), list(range(<span class="hljs-number">1985</span>, <span class="hljs-number">2023</span>))):
            search_words.append(<span class="hljs-string">f'<span class="hljs-subst">{word}</span> year:<span class="hljs-subst">{year}</span>'</span>)
        <span class="hljs-keyword">return</span> search_words


<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">'__main__'</span>:
    my_client_id = <span class="hljs-string">'Your Client ID'</span>
    my_client_secret = <span class="hljs-string">'Your Client Secret'</span>
    my_output_path = <span class="hljs-string">r'result_spotify.csv'</span>

    crawler = CrawlerSpotify(client_id=my_client_id, client_secret=my_client_secret)
    data_tracks = crawler.save_tracks(output_path=my_output_path)  <span class="hljs-comment"># 1,368,207 tracks</span>

    <span class="hljs-comment"># delete duplicates</span>
    data = pd.read_csv(my_output_path)
    data_final = data.drop_duplicates().reset_index(drop=<span class="hljs-keyword">True</span>)  <span class="hljs-comment"># 573,131 tracks</span>
    data_final.to_csv(<span class="hljs-string">r'result_spotify_noduplicates.csv'</span>, index=<span class="hljs-keyword">False</span>, encoding=<span class="hljs-string">'utf-8-sig'</span>)
    <span class="hljs-comment"># data_final['loudness'].isna().sum()  # 615 tracks can not extract audio features</span>


<span class="hljs-comment"># Returns 573k tracks which we split into tsv.gz files to upload to github</span></code></pre>
<div style="page-break-after: always;"></div>
</div>
</div>
<div id="section-data-preparation-and-cleaning" class="section level2">
<h2>Data Preparation and Cleaning</h2>
<p>Scraping the Spotify API resulted in the generation of three datasets
of Spotify Songs. These datasets were cleaned and combined to generate a
single database of songs.</p>
<pre class="r"><code class="hljs">list.files()</code></pre>
<pre><code class="hljs">##  [1] "cl_summary.png"                  "Descriptive Plots"              
##  [3] "Final_Presentation.html"         "Final_Presentation.md"          
##  [5] "Final_Presentation.Rpres"        "Final_Project_Final_Version.Rmd"
##  [7] "gbm_cl_int_depth_iter.png"       "gbm_reg_int_depth_iter.png"     
##  [9] "Older_Versions"                  "reg_summary.png"                
## [11] "rf_cl_mtry.png"                  "rf_cl_varimp.png"               
## [13] "rf_reg_mtry.png"                 "rf_reg_varimp.png"              
## [15] "songs.tsv"                       "songs2.tsv.gz"                  
## [17] "songs3.tsv.gz"                   "svm_cl_cost.png"                
## [19] "svm_reg_cost.png"</code></pre>
<pre class="r"><code class="hljs"><span class="hljs-comment"># this was generated in R - the files have been renamed for convenience</span>
songs &lt;- read_tsv(<span class="hljs-string">"songs.tsv"</span>, col_names = <span class="hljs-literal">TRUE</span>, show_col_types = <span class="hljs-literal">FALSE</span>)

<span class="hljs-comment"># These were generated in Python - the files have been renamed for convenience</span>
songs2 &lt;- read_tsv(<span class="hljs-string">"songs2.tsv.gz"</span>, col_names = <span class="hljs-literal">TRUE</span>, show_col_types = <span class="hljs-literal">FALSE</span>)

songs3 &lt;- read_tsv(<span class="hljs-string">"songs3.tsv.gz"</span>, col_names = <span class="hljs-literal">TRUE</span>, show_col_types = <span class="hljs-literal">FALSE</span>)</code></pre>
<p>Synchronize column names and order:</p>
<pre class="r"><code class="hljs">colnames(songs)</code></pre>
<pre><code class="hljs">##  [1] "X"                    "TrackID"              "SongName"            
##  [4] "Artist"               "Popularity"           "Danceability"        
##  [7] "Energy"               "Key"                  "Loudness"            
## [10] "Mode"                 "Speachiness"          "Acousticness"        
## [13] "Instrumentalness"     "Liveness"             "Valence"             
## [16] "Tempo"                "Duration"             "Popularity_Quantized"</code></pre>
<pre class="r"><code class="hljs">table(colnames(songs2) == colnames(songs3))</code></pre>
<pre><code class="hljs">## 
## TRUE 
##   20</code></pre>
<pre class="r"><code class="hljs">songs &lt;- songs[, -c(<span class="hljs-number">1</span>, <span class="hljs-number">18</span>)]
songs2 &lt;- songs2[, -c(<span class="hljs-number">1</span>, <span class="hljs-number">6</span>:<span class="hljs-number">8</span>)]
songs3 &lt;- songs3[, -c(<span class="hljs-number">1</span>, <span class="hljs-number">6</span>:<span class="hljs-number">8</span>)]</code></pre>
<pre class="r"><code class="hljs">names(songs2) &lt;- colnames(songs)

names(songs3) &lt;- colnames(songs)</code></pre>
<p>Combine all datasets:</p>
<pre class="r"><code class="hljs">songs_combined &lt;- data.frame(rbind(songs, songs2, songs3))

str(songs_combined)</code></pre>
<pre><code class="hljs">## 'data.frame':    661956 obs. of  16 variables:
##  $ TrackID         : chr  "2uflssWlCaJ6CbTMOsUpNI" "46M2hXnaQpueG7vSvgVtVH" "0wihfILRNOwE2156Shezc8" "2Y0iGXY6m6immVb2ktbseM" ...
##  $ SongName        : chr  "Aguacero" "GTG" "Agosto" "Little Dark Age" ...
##  $ Artist          : chr  "Bad Bunny" "Freddie Dredd" "Bad Bunny" "MGMT" ...
##  $ Popularity      : num  83 76 82 82 70 76 66 51 73 67 ...
##  $ Danceability    : num  0.861 0.88 0.849 0.705 0.708 0.822 0.547 0.686 0.603 0.815 ...
##  $ Energy          : num  0.645 0.777 0.584 0.712 0.912 0.59 0.453 0.433 0.204 0.697 ...
##  $ Key             : chr  "6" "7" "1" "6" ...
##  $ Loudness        : num  -6.96 -6.88 -8.2 -6.16 -3.19 ...
##  $ Mode            : chr  "0" "0" "0" "1" ...
##  $ Speachiness     : num  0.0743 0.125 0.115 0.0385 0.0838 0.18 0.0358 0.0339 0.112 0.219 ...
##  $ Acousticness    : num  0.423 0.164 0.0929 0.0102 0.487 0.429 0.189 0.239 0.479 0.778 ...
##  $ Instrumentalness: num  5.92e-04 1.71e-02 6.18e-06 8.55e-04 1.77e-02 0.00 3.29e-02 1.80e-01 7.14e-02 3.98e-04 ...
##  $ Liveness        : num  0.349 0.0957 0.492 0.1 0.79 0.102 0.119 0.0898 0.642 0.102 ...
##  $ Valence         : num  0.668 0.974 0.724 0.62 0.571 0.383 0.412 0.389 0.71 0.147 ...
##  $ Tempo           : num  121.4 155 115 97.5 118 ...
##  $ Duration        : num  210989 93893 139041 299960 150466 ...</code></pre>
<p>Scan for duplicates:</p>
<pre class="r"><code class="hljs">dupes &lt;- songs_combined %&gt;%
    janitor::get_dupes(TrackID)

<span class="hljs-comment"># nrow(dupes)</span></code></pre>
<p>There were 3.23125^{4} duplicate track IDs in the combined dataset.
These duplicated rows were removed.</p>
<pre class="r"><code class="hljs">songs_combined &lt;- songs_combined %&gt;%
    filter(duplicated(TrackID) == <span class="hljs-literal">FALSE</span>)</code></pre>
<p>Confirm that duplicate rows have been removed:</p>
<pre class="r"><code class="hljs">songs_combined %&gt;%
    janitor::get_dupes(TrackID)</code></pre>
<pre><code class="hljs">## No duplicate combinations found of: TrackID</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["TrackID"],"name":[1],"type":["chr"],"align":["left"]},{"label":["dupe_count"],"name":[2],"type":["int"],"align":["right"]},{"label":["SongName"],"name":[3],"type":["chr"],"align":["left"]},{"label":["Artist"],"name":[4],"type":["chr"],"align":["left"]},{"label":["Popularity"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["Danceability"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["Energy"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["Key"],"name":[8],"type":["chr"],"align":["left"]},{"label":["Loudness"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["Mode"],"name":[10],"type":["chr"],"align":["left"]},{"label":["Speachiness"],"name":[11],"type":["dbl"],"align":["right"]},{"label":["Acousticness"],"name":[12],"type":["dbl"],"align":["right"]},{"label":["Instrumentalness"],"name":[13],"type":["dbl"],"align":["right"]},{"label":["Liveness"],"name":[14],"type":["dbl"],"align":["right"]},{"label":["Valence"],"name":[15],"type":["dbl"],"align":["right"]},{"label":["Tempo"],"name":[16],"type":["dbl"],"align":["right"]},{"label":["Duration"],"name":[17],"type":["dbl"],"align":["right"]}],"data":[],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>The “mode” attribute codes whether the song is written in a major or
minor key and is stored as a binary numeric variable (0 = minor; 1 =
mojor). For interpretability, this attribute was decoded.</p>
<pre class="r"><code class="hljs">songs_combined$Mode &lt;- case_when(songs_combined$Mode == <span class="hljs-number">1</span> ~ <span class="hljs-string">"Major"</span>, songs_combined$Mode ==
    <span class="hljs-number">0</span> ~ <span class="hljs-string">"Minor"</span>)</code></pre>
<p>Similarly, each song’s key is stored as a numeric variable and was
decoded for interpretability:</p>
<pre class="r"><code class="hljs">songs_combined$Key &lt;- case_when(songs_combined$Key == <span class="hljs-number">0</span> ~ <span class="hljs-string">"C"</span>, songs_combined$Key ==
    <span class="hljs-number">1</span> ~ <span class="hljs-string">"C#/Db"</span>, songs_combined$Key == <span class="hljs-number">2</span> ~ <span class="hljs-string">"D"</span>, songs_combined$Key == <span class="hljs-number">3</span> ~ <span class="hljs-string">"D#/Eb"</span>,
    songs_combined$Key == <span class="hljs-number">4</span> ~ <span class="hljs-string">"E"</span>, songs_combined$Key == <span class="hljs-number">5</span> ~ <span class="hljs-string">"F"</span>, songs_combined$Key ==
        <span class="hljs-number">6</span> ~ <span class="hljs-string">"F#/Gb"</span>, songs_combined$Key == <span class="hljs-number">7</span> ~ <span class="hljs-string">"G"</span>, songs_combined$Key == <span class="hljs-number">8</span> ~ <span class="hljs-string">"G#/Ab"</span>,
    songs_combined$Key == <span class="hljs-number">9</span> ~ <span class="hljs-string">"A"</span>, songs_combined$Key == <span class="hljs-number">10</span> ~ <span class="hljs-string">"A#/Bb"</span>, songs_combined$Key ==
        <span class="hljs-number">11</span> ~ <span class="hljs-string">"B"</span>)</code></pre>
<p>Finally, the popularity index was quantized in order to convert it
from a numeric to a categorical variable. This will be useful for
classification models that require categorical independent
variables.</p>
<pre class="r"><code class="hljs">songs_combined &lt;- songs_combined %&gt;%
    mutate(Popularity_quantized = cut(Popularity, breaks = c(<span class="hljs-number">0</span>, <span class="hljs-number">25</span>, <span class="hljs-number">50</span>, <span class="hljs-number">75</span>, <span class="hljs-number">100</span>),
        include.lowest = <span class="hljs-literal">TRUE</span>))

<span class="hljs-comment"># table(songs_combined$Popularity_quantized)</span>

songs_combined$Popularity_quantized &lt;- factor(songs_combined$Popularity_quantized)

<span class="hljs-comment"># levels(songs_combined$Popularity_quantized)</span></code></pre>
<p>Finally, remove rows with NA values</p>
<pre class="r"><code class="hljs">songs_combined &lt;- songs_combined %&gt;%
    drop_na()</code></pre>
</div>
<div id="section-exploratory-analysis" class="section level2">
<h2>Exploratory Analysis</h2>
<p>There were 579108 songs from 98589 artists in the combined Spotify
Songs dataset.</p>
<div id="section-song-popularity" class="section level3">
<h3>Song Popularity</h3>
<p>Distribution of song popularity indices:</p>
<pre class="r"><code class="hljs">hist(songs_combined$Popularity, main = <span class="hljs-string">"Distribution of Song Popularity Indices"</span>)</code></pre>
<p><img src="./Final_Project_Final_Version_files/unnamed-chunk-16-1.png" width="672"></p>
<p>Here is Shiny capability to try out</p>
<pre class="r"><code class="hljs">sliderInput(<span class="hljs-string">"bins"</span>, <span class="hljs-string">"Number of bins:"</span>, <span class="hljs-number">30</span>, min = <span class="hljs-number">1</span>, max = <span class="hljs-number">50</span>)</code></pre>
<div class="form-group shiny-input-container">
<label class="control-label" id="bins-label" for="bins">Number of bins:</label>
<span class="irs irs--shiny js-irs-0 irs-with-grid"><span class="irs"><span class="irs-line" tabindex="0"></span><span class="irs-min" style="visibility: visible;">1</span><span class="irs-max" style="visibility: visible;">50</span><span class="irs-from" style="visibility: hidden;">0</span><span class="irs-to" style="visibility: hidden;">0</span><span class="irs-single" style="left: 85.7291%;">46</span></span><span class="irs-grid" style="width: 92.6667%; left: 3.56667%;"><span class="irs-grid-pol" style="left: 0%"></span><span class="irs-grid-text js-grid-text-0" style="left: 0%; margin-left: -1.83542%;">1</span><span class="irs-grid-pol small" style="left: 6.802721088435375%"></span><span class="irs-grid-pol small" style="left: 3.4013605442176873%"></span><span class="irs-grid-pol" style="left: 10.204081632653061%"></span><span class="irs-grid-text js-grid-text-1" style="left: 10.2041%; visibility: visible; margin-left: -1.83542%;">6</span><span class="irs-grid-pol small" style="left: 17.006802721088434%"></span><span class="irs-grid-pol small" style="left: 13.60544217687075%"></span><span class="irs-grid-pol" style="left: 20.408163265306122%"></span><span class="irs-grid-text js-grid-text-2" style="left: 20.4082%; visibility: visible; margin-left: -2.55833%;">11</span><span class="irs-grid-pol small" style="left: 27.210884353741495%"></span><span class="irs-grid-pol small" style="left: 23.80952380952381%"></span><span class="irs-grid-pol" style="left: 30.612244897959183%"></span><span class="irs-grid-text js-grid-text-3" style="left: 30.6122%; visibility: visible; margin-left: -2.66875%;">16</span><span class="irs-grid-pol small" style="left: 37.414965986394556%"></span><span class="irs-grid-pol small" style="left: 34.01360544217687%"></span><span class="irs-grid-pol" style="left: 40.816326530612244%"></span><span class="irs-grid-text js-grid-text-4" style="left: 40.8163%; margin-left: -2.66875%;">21</span><span class="irs-grid-pol small" style="left: 47.61904761904761%"></span><span class="irs-grid-pol small" style="left: 44.21768707482993%"></span><span class="irs-grid-pol" style="left: 51.0204081632653%"></span><span class="irs-grid-text js-grid-text-5" style="left: 51.0204%; visibility: visible; margin-left: -2.66875%;">26</span><span class="irs-grid-pol small" style="left: 57.82312925170068%"></span><span class="irs-grid-pol small" style="left: 54.42176870748299%"></span><span class="irs-grid-pol" style="left: 61.224489795918366%"></span><span class="irs-grid-text js-grid-text-6" style="left: 61.2245%; visibility: visible; margin-left: -2.66875%;">31</span><span class="irs-grid-pol small" style="left: 68.02721088435374%"></span><span class="irs-grid-pol small" style="left: 64.62585034013605%"></span><span class="irs-grid-pol" style="left: 71.42857142857143%"></span><span class="irs-grid-text js-grid-text-7" style="left: 71.4286%; visibility: visible; margin-left: -2.66875%;">36</span><span class="irs-grid-pol small" style="left: 78.2312925170068%"></span><span class="irs-grid-pol small" style="left: 74.82993197278911%"></span><span class="irs-grid-pol" style="left: 81.63265306122449%"></span><span class="irs-grid-text js-grid-text-8" style="left: 81.6327%; margin-left: -2.66875%;">41</span><span class="irs-grid-pol small" style="left: 88.43537414965986%"></span><span class="irs-grid-pol small" style="left: 85.03401360544217%"></span><span class="irs-grid-pol" style="left: 91.83673469387755%"></span><span class="irs-grid-text js-grid-text-9" style="left: 91.8367%; visibility: visible; margin-left: -2.66875%;">46</span><span class="irs-grid-pol small" style="left: 97.27891156462584%"></span><span class="irs-grid-pol small" style="left: 94.5578231292517%"></span><span class="irs-grid-pol" style="left: 100%"></span><span class="irs-grid-text js-grid-text-10" style="left: 100%; visibility: visible; margin-left: -2.66875%;">50</span></span><span class="irs-bar irs-bar--single" style="left: 0px; width: 88.7687%;"></span><span class="irs-shadow shadow-single" style="display: none;"></span><span class="irs-handle single" style="left: 85.102%;"><i></i><i></i><i></i></span></span><input class="js-range-slider irs-hidden-input shiny-bound-input" id="bins" data-skin="shiny" data-min="1" data-max="50" data-from="30" data-step="1" data-grid="true" data-grid-num="9.8" data-grid-snap="false" data-prettify-separator="," data-prettify-enabled="true" data-keyboard="true" data-data-type="number" tabindex="-1" readonly="">
</div>
<pre class="r"><code class="hljs">renderPlot({
    x = songs_combined$Popularity
    bins = seq(min(x), max(x), length.out = input$bins + <span class="hljs-number">1</span>)

    <span class="hljs-comment"># draw the histogram with the specified number of bins</span>
    hist(x, breaks = bins, col = <span class="hljs-string">"darkgray"</span>, border = <span class="hljs-string">"white"</span>)
})</code></pre>
<div id="out869cb8f63240e77b" class="shiny-plot-output shiny-bound-output" style="width:100%;height:400px;" aria-live="polite"><img src="data:image/png;base64,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" width="910" height="400" alt="Plot object"></div>
<p>Distribution of quantized popularity indices:</p>
<pre class="r"><code class="hljs">quant_pop &lt;- data.frame(table(songs_combined$Popularity_quantized))

names(quant_pop)[<span class="hljs-number">1</span>] &lt;- <span class="hljs-string">"Quantized Popularity"</span>

ggplot(quant_pop, aes(x = `Quantized Popularity`, y = Freq, fill = `Quantized Popularity`)) +
    geom_bar(stat = <span class="hljs-string">"identity"</span>) + geom_text(aes(label = Freq), vjust = <span class="hljs-number">0</span>) + theme_bw() +
    ggtitle(<span class="hljs-string">"Quantized Popularity Frequencies"</span>)</code></pre>
<p><img src="./Final_Project_Final_Version_files/unnamed-chunk-18-1.png" width="672"></p>
<pre class="r"><code class="hljs">kable(quant_pop)</code></pre>
<table>
<thead>
<tr>
<th style="text-align:left;">
Quantized Popularity
</th>
<th style="text-align:right;">
Freq
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
[0,25]
</td>
<td style="text-align:right;">
282752
</td>
</tr>
<tr>
<td style="text-align:left;">
(25,50]
</td>
<td style="text-align:right;">
236662
</td>
</tr>
<tr>
<td style="text-align:left;">
(50,75]
</td>
<td style="text-align:right;">
58462
</td>
</tr>
<tr>
<td style="text-align:left;">
(75,100]
</td>
<td style="text-align:right;">
1232
</td>
</tr>
</tbody>
</table>
<p>Clearly, popular songs are rare in this dataset and the majority of
songs had low popularity.</p>
<p>The top twenty most popular songs:</p>
<pre class="r"><code class="hljs">songs_combined %&gt;%
    arrange(desc(Popularity)) %&gt;%
    dplyr::select(SongName, Artist, Popularity) %&gt;%
    top_n(<span class="hljs-number">20</span>) %&gt;%
    kable</code></pre>
<pre><code class="hljs">## Selecting by Popularity</code></pre>
<table>
<thead>
<tr>
<th style="text-align:left;">
SongName
</th>
<th style="text-align:left;">
Artist
</th>
<th style="text-align:right;">
Popularity
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Unholy (feat. Kim Petras)
</td>
<td style="text-align:left;">
c(""Sam Smith"", ""Kim Petras"")
</td>
<td style="text-align:right;">
100
</td>
</tr>
<tr>
<td style="text-align:left;">
Quevedo: Bzrp Music Sessions, Vol. 52
</td>
<td style="text-align:left;">
c(""Bizarrap"", ""Quevedo"")
</td>
<td style="text-align:right;">
97
</td>
</tr>
<tr>
<td style="text-align:left;">
La Bachata
</td>
<td style="text-align:left;">
Manuel Turizo
</td>
<td style="text-align:right;">
97
</td>
</tr>
<tr>
<td style="text-align:left;">
I’m Good (Blue)
</td>
<td style="text-align:left;">
c(""David Guetta"", ""Bebe Rexha"")
</td>
<td style="text-align:right;">
97
</td>
</tr>
<tr>
<td style="text-align:left;">
Tití Me Preguntó
</td>
<td style="text-align:left;">
Bad Bunny
</td>
<td style="text-align:right;">
96
</td>
</tr>
<tr>
<td style="text-align:left;">
Me Porto Bonito
</td>
<td style="text-align:left;">
c(""Bad Bunny"", ""Chencho Corleone"")
</td>
<td style="text-align:right;">
96
</td>
</tr>
<tr>
<td style="text-align:left;">
I Ain’t Worried
</td>
<td style="text-align:left;">
OneRepublic
</td>
<td style="text-align:right;">
95
</td>
</tr>
<tr>
<td style="text-align:left;">
Under The Influence
</td>
<td style="text-align:left;">
Chris Brown
</td>
<td style="text-align:right;">
95
</td>
</tr>
<tr>
<td style="text-align:left;">
Anti-Hero
</td>
<td style="text-align:left;">
Taylor Swift
</td>
<td style="text-align:right;">
94
</td>
</tr>
<tr>
<td style="text-align:left;">
Efecto
</td>
<td style="text-align:left;">
Bad Bunny
</td>
<td style="text-align:right;">
94
</td>
</tr>
<tr>
<td style="text-align:left;">
As It Was
</td>
<td style="text-align:left;">
Harry Styles
</td>
<td style="text-align:right;">
94
</td>
</tr>
<tr>
<td style="text-align:left;">
Ojitos Lindos
</td>
<td style="text-align:left;">
c(""Bad Bunny"", ""Bomba Estéreo"")
</td>
<td style="text-align:right;">
93
</td>
</tr>
<tr>
<td style="text-align:left;">
Glimpse of Us
</td>
<td style="text-align:left;">
Joji
</td>
<td style="text-align:right;">
93
</td>
</tr>
<tr>
<td style="text-align:left;">
CUFF IT
</td>
<td style="text-align:left;">
Beyoncé
</td>
<td style="text-align:right;">
93
</td>
</tr>
<tr>
<td style="text-align:left;">
Romantic Homicide
</td>
<td style="text-align:left;">
d4vd
</td>
<td style="text-align:right;">
93
</td>
</tr>
<tr>
<td style="text-align:left;">
SNAP
</td>
<td style="text-align:left;">
Rosa Linn
</td>
<td style="text-align:right;">
93
</td>
</tr>
<tr>
<td style="text-align:left;">
Moscow Mule
</td>
<td style="text-align:left;">
Bad Bunny
</td>
<td style="text-align:right;">
92
</td>
</tr>
<tr>
<td style="text-align:left;">
Neverita
</td>
<td style="text-align:left;">
Bad Bunny
</td>
<td style="text-align:right;">
92
</td>
</tr>
<tr>
<td style="text-align:left;">
PROVENZA
</td>
<td style="text-align:left;">
KAROL G
</td>
<td style="text-align:right;">
92
</td>
</tr>
<tr>
<td style="text-align:left;">
Calm Down (with Selena Gomez)
</td>
<td style="text-align:left;">
c(""Rema"", ""Selena Gomez"")
</td>
<td style="text-align:right;">
92
</td>
</tr>
<tr>
<td style="text-align:left;">
DESPECHÁ
</td>
<td style="text-align:left;">
ROSALÍA
</td>
<td style="text-align:right;">
92
</td>
</tr>
<tr>
<td style="text-align:left;">
Another Love
</td>
<td style="text-align:left;">
Tom Odell
</td>
<td style="text-align:right;">
92
</td>
</tr>
</tbody>
</table>
<p>Now, the interactive, shiny version of the table - the user can
select how many songs to look at.</p>
<div class="form-group shiny-input-container">
<label class="control-label" id="rows-label" for="rows">How Many Songs?</label>
<input id="rows" type="number" class="form-control shiny-bound-input" value="5">
</div>
<div id="out7c3bb5d4e10f27b8" class="shiny-html-output shiny-bound-output" aria-live="polite"><table class="table shiny-table table- spacing-s" style="width:auto;">
<thead> <tr> <th style="text-align: left;"> SongName </th> <th style="text-align: left;"> Artist </th> <th style="text-align: right;"> Popularity </th>  </tr> </thead> <tbody>
  <tr> <td> Unholy (feat. Kim Petras) </td> <td> c(""Sam Smith"", ""Kim Petras"") </td> <td align="right"> 100.00 </td> </tr>
  <tr> <td> Quevedo: Bzrp Music Sessions, Vol. 52 </td> <td> c(""Bizarrap"", ""Quevedo"") </td> <td align="right"> 97.00 </td> </tr>
  <tr> <td> La Bachata </td> <td> Manuel Turizo </td> <td align="right"> 97.00 </td> </tr>
  <tr> <td> I'm Good (Blue) </td> <td> c(""David Guetta"", ""Bebe Rexha"") </td> <td align="right"> 97.00 </td> </tr>
  <tr> <td> Tití Me Preguntó </td> <td> Bad Bunny </td> <td align="right"> 96.00 </td> </tr>
  <tr> <td> Me Porto Bonito </td> <td> c(""Bad Bunny"", ""Chencho Corleone"") </td> <td align="right"> 96.00 </td> </tr>
   </tbody> </table></div>
</div>
</div>
<div id="section-acoustic-attributes" class="section level2">
<h2>Acoustic Attributes</h2>
<p>Distributions of acoustic variables (raw data):</p>
<pre class="r"><code class="hljs">hist.data.frame(songs_combined[, c(<span class="hljs-number">5</span>:<span class="hljs-number">6</span>, <span class="hljs-number">8</span>, <span class="hljs-number">10</span>:<span class="hljs-number">16</span>)])</code></pre>
<p><img src="./Final_Project_Final_Version_files/unnamed-chunk-22-1.png" width="672"></p>
<div id="section-principal-component-analysis" class="section level3">
<h3>Principal Component Analysis</h3>
<pre class="r"><code class="hljs">num_cols &lt;- unlist(lapply(songs_combined, is.numeric))

pca &lt;- PCA(songs_combined[, c(<span class="hljs-number">5</span>:<span class="hljs-number">6</span>, <span class="hljs-number">8</span>, <span class="hljs-number">10</span>:<span class="hljs-number">16</span>)], graph = <span class="hljs-literal">F</span>, scale.unit = <span class="hljs-literal">T</span>)

fviz_eig(pca)</code></pre>
<p><img src="./Final_Project_Final_Version_files/unnamed-chunk-23-1.png" width="672"></p>
<pre class="r"><code class="hljs">summary(pca)</code></pre>
<pre><code class="hljs">## 
## Call:
## PCA(X = songs_combined[, c(5:6, 8, 10:16)], scale.unit = T, graph = F) 
## 
## 
## Eigenvalues
##                        Dim.1   Dim.2   Dim.3   Dim.4   Dim.5   Dim.6   Dim.7
## Variance               3.330   1.474   1.178   0.954   0.859   0.749   0.643
## % of var.             33.297  14.740  11.776   9.542   8.590   7.489   6.425
## Cumulative % of var.  33.297  48.037  59.813  69.355  77.945  85.434  91.859
##                        Dim.8   Dim.9  Dim.10
## Variance               0.380   0.309   0.126
## % of var.              3.797   3.086   1.258
## Cumulative % of var.  95.656  98.742 100.000
## 
## Individuals (the 10 first)
##                      Dist    Dim.1    ctr   cos2    Dim.2    ctr   cos2  
## 1                |  2.126 |  1.460  0.000  0.471 |  0.697  0.000  0.108 |
## 2                |  3.247 |  2.507  0.000  0.596 |  0.996  0.000  0.094 |
## 3                |  2.653 |  1.777  0.000  0.449 |  0.888  0.000  0.112 |
## 4                |  2.124 |  1.510  0.000  0.505 | -0.140  0.000  0.004 |
## 5                |  3.727 |  1.899  0.000  0.260 | -0.042  0.000  0.000 |
## 6                |  1.988 |  0.596  0.000  0.090 |  0.920  0.000  0.214 |
## 7                |  2.062 |  0.080  0.000  0.002 |  0.343  0.000  0.028 |
## 8                |  1.701 |  0.097  0.000  0.003 |  0.357  0.000  0.044 |
## 9                |  3.132 | -0.300  0.000  0.009 |  1.181  0.000  0.142 |
## 10               |  2.583 |  0.038  0.000  0.000 |  1.106  0.000  0.183 |
##                   Dim.3    ctr   cos2  
## 1                 0.000  0.000  0.000 |
## 2                -1.485  0.000  0.209 |
## 3                 0.573  0.000  0.047 |
## 4                -0.540  0.000  0.065 |
## 5                 2.006  0.001  0.290 |
## 6                -0.274  0.000  0.019 |
## 7                -0.404  0.000  0.038 |
## 8                -0.713  0.000  0.176 |
## 9                 1.429  0.000  0.208 |
## 10               -0.151  0.000  0.003 |
## 
## Variables
##                     Dim.1    ctr   cos2    Dim.2    ctr   cos2    Dim.3    ctr
## Danceability     |  0.598 10.726  0.357 |  0.556 20.990  0.309 | -0.204  3.543
## Energy           |  0.851 21.759  0.725 | -0.334  7.583  0.112 |  0.089  0.680
## Loudness         |  0.869 22.686  0.755 | -0.228  3.512  0.052 | -0.013  0.013
## Speachiness      |  0.052  0.081  0.003 |  0.663 29.849  0.440 |  0.501 21.355
## Acousticness     | -0.780 18.290  0.609 |  0.284  5.461  0.080 | -0.064  0.352
## Instrumentalness | -0.617 11.429  0.381 | -0.290  5.715  0.084 | -0.177  2.657
## Liveness         |  0.156  0.734  0.024 | -0.070  0.331  0.005 |  0.818 56.769
## Valence          |  0.605 10.976  0.365 |  0.345  8.055  0.119 | -0.302  7.723
## Tempo            |  0.315  2.978  0.099 | -0.275  5.149  0.076 | -0.154  2.018
## Duration         | -0.106  0.340  0.011 | -0.444 13.356  0.197 |  0.240  4.891
##                    cos2  
## Danceability      0.042 |
## Energy            0.008 |
## Loudness          0.000 |
## Speachiness       0.251 |
## Acousticness      0.004 |
## Instrumentalness  0.031 |
## Liveness          0.669 |
## Valence           0.091 |
## Tempo             0.024 |
## Duration          0.058 |</code></pre>
<pre class="r"><code class="hljs"><span class="hljs-comment"># summary(pca)</span></code></pre>
<pre class="r"><code class="hljs"><span class="hljs-comment"># format pca data for plotting</span>

dat_pca &lt;- data.frame(pca$ind$coord[, <span class="hljs-number">1</span>], pca$ind$coord[, <span class="hljs-number">2</span>])

names(dat_pca) &lt;- c(<span class="hljs-string">"PC1"</span>, <span class="hljs-string">"PC2"</span>)

pca.vars &lt;- pca$var$coord %&gt;%
    data.frame

pca.vars$vars &lt;- rownames(pca.vars)

pca.vars.m &lt;- melt(pca.vars, id.vars = <span class="hljs-string">"vars"</span>)

dat_pca$Popularity_quantized &lt;- factor(songs_combined$Popularity_quantized)

dat_pca &lt;- dat_pca %&gt;%
    na.omit()

ggplot(data = dat_pca, aes(x = PC1, y = PC2, color = Popularity_quantized)) + scale_color_manual(values = c(<span class="hljs-string">"blue"</span>,
    <span class="hljs-string">"orange"</span>, <span class="hljs-string">"green"</span>, <span class="hljs-string">"purple"</span>)) + geom_hline(yintercept = <span class="hljs-number">0</span>, lty = <span class="hljs-number">2</span>) + geom_vline(xintercept = <span class="hljs-number">0</span>,
    lty = <span class="hljs-number">2</span>) + guides(color = guide_legend(title = <span class="hljs-string">"Song Popularity (Quantized)"</span>)) +
    scale_shape_manual(values = c(<span class="hljs-number">15</span>, <span class="hljs-number">16</span>, <span class="hljs-number">16</span>, <span class="hljs-number">17</span>, <span class="hljs-number">18</span>)) + geom_point(alpha = <span class="hljs-number">0.5</span>,
    size = <span class="hljs-number">1</span>) + xlab(<span class="hljs-string">"PC 1 (33.3%)"</span>) + ylab(<span class="hljs-string">"PC 2 (14.7%)"</span>) + facet_wrap(vars(Popularity_quantized)) +
    theme_minimal() + theme(panel.grid = element_blank(), panel.border = element_rect(fill = <span class="hljs-string">"transparent"</span>)) +
    theme(legend.position = <span class="hljs-string">"bottom"</span>) + theme(legend.title = element_text(size = <span class="hljs-number">14</span>),
    legend.text = element_text(size = <span class="hljs-number">12</span>)) + ggtitle(<span class="hljs-string">"PCA of Acoustic Attributes"</span>)</code></pre>
<p><img src="./Final_Project_Final_Version_files/unnamed-chunk-24-1.png" width="672"></p>
<p>Because there are so many datapoints, the PCA plots are faceted by
the quantized popularity indices.</p>
<p>Interactive Shiny PCA plot:</p>
<pre class="r"><code class="hljs">fluidRow(style = <span class="hljs-string">"padding-bottom: 20px;"</span>, column(<span class="hljs-number">4</span>, selectInput(<span class="hljs-string">"group"</span>, <span class="hljs-string">"Popularity Index (Quantized) Group"</span>,
    dat_pca$Popularity_quantized)), column(<span class="hljs-number">4</span>, selectInput(<span class="hljs-string">"color"</span>, <span class="hljs-string">"Group Color"</span>,
    c(<span class="hljs-string">"blue"</span>, <span class="hljs-string">"orange"</span>, <span class="hljs-string">"green"</span>, <span class="hljs-string">"purple"</span>))))</code></pre>
<pre><code class="hljs">## Warning: The select input "group" contains a large number of options; consider
## using server-side selectize for massively improved performance. See the Details
## section of the ?selectizeInput help topic.</code></pre>
<div class="row" style="padding-bottom: 20px;">
<div class="col-sm-4">
<div class="form-group shiny-input-container">
<label class="control-label" id="group-label" for="group-selectized">Popularity Index (Quantized) Group</label>
<div>
<select id="group" tabindex="-1" class="selectized shiny-bound-input" style="display: none;"><option value="" selected="selected"></option></select><div class="selectize-control single plugin-selectize-plugin-a11y"><div class="selectize-input items not-full has-options"><input type="text" autocomplete="off" tabindex="" id="group-selectized" role="combobox" aria-expanded="false" haspopup="listbox" aria-owns="j9r94faps2" style="width: 4px;"></div><div class="selectize-dropdown single plugin-selectize-plugin-a11y" style="display: none;"><div class="selectize-dropdown-content" role="listbox" id="j9r94faps2"></div></div></div>
<script type="application/json" data-for="group" data-nonempty="">{"plugins":["selectize-plugin-a11y"]}</script>
</div>
</div>
</div>
<div class="col-sm-4">
<div class="form-group shiny-input-container">
<label class="control-label" id="color-label" for="color-selectized">Group Color</label>
<div>
<select id="color" tabindex="-1" class="selectized shiny-bound-input" style="display: none;"><option value="blue" selected="selected">blue</option></select><div class="selectize-control single plugin-selectize-plugin-a11y"><div class="selectize-input items full has-options has-items"><div class="item" data-value="blue">blue</div><input type="text" autocomplete="off" tabindex="" id="color-selectized" role="combobox" aria-expanded="false" haspopup="listbox" aria-owns="n00tzasvtt" style="width: 4px;"></div><div class="selectize-dropdown single plugin-selectize-plugin-a11y" style="display: none;"><div class="selectize-dropdown-content" role="listbox" id="n00tzasvtt"></div></div></div>
<script type="application/json" data-for="color" data-nonempty="">{"plugins":["selectize-plugin-a11y"]}</script>
</div>
</div>
</div>
</div>
<pre class="r"><code class="hljs">renderPlot({
    ggplot(data = dat_pca[dat_pca$Popularity_quantized == input$group, ], aes(x = PC1,
        y = PC2, color = Popularity_quantized)) + geom_point(alpha = <span class="hljs-number">0.5</span>, size = <span class="hljs-number">1</span>) +
        scale_color_manual(values = input$color) + geom_hline(yintercept = <span class="hljs-number">0</span>, lty = <span class="hljs-number">2</span>) +
        geom_vline(xintercept = <span class="hljs-number">0</span>, lty = <span class="hljs-number">2</span>) + scale_shape_manual(values = c(<span class="hljs-number">15</span>, <span class="hljs-number">16</span>,
        <span class="hljs-number">16</span>, <span class="hljs-number">17</span>, <span class="hljs-number">18</span>)) + xlab(<span class="hljs-string">"PC 1 (33.3%)"</span>) + ylab(<span class="hljs-string">"PC 2 (14.7%)"</span>) + theme_minimal() +
        theme(panel.grid = element_blank(), panel.border = element_rect(fill = <span class="hljs-string">"transparent"</span>)) +
        theme(legend.position = <span class="hljs-string">"bottom"</span>) + theme(legend.title = element_text(size = <span class="hljs-number">14</span>),
        legend.text = element_text(size = <span class="hljs-number">12</span>)) + ggtitle(<span class="hljs-string">"PCA of Acoustic Attributes (Interactive)"</span>)


})</code></pre>
<div id="out722a517571b29441" class="shiny-plot-output shiny-bound-output" style="width:100%;height:400px;" aria-live="polite"><img src="data:image/png;base64,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" width="910" height="400" alt="Plot object"></div>
</div>
<div id="section-correlation-analysis" class="section level3">
<h3>Correlation Analysis</h3>
<p>Here we sought to determine if sonic attributes are correlated with
song popularity.</p>
<pre class="r"><code class="hljs"><span class="hljs-comment"># this takes a couple of minutes to run</span>

songs_combined[, c(<span class="hljs-number">4</span>, <span class="hljs-number">5</span>:<span class="hljs-number">6</span>, <span class="hljs-number">8</span>, <span class="hljs-number">10</span>:<span class="hljs-number">16</span>)] %&gt;%
    gather(-Popularity, key = <span class="hljs-string">"var"</span>, value = <span class="hljs-string">"value"</span>) %&gt;%
    ggplot(aes(x = value, y = Popularity)) + geom_point(size = <span class="hljs-number">1</span>) + facet_wrap(~var,
    scales = <span class="hljs-string">"free"</span>) + theme_bw()</code></pre>
<p><img src="./Final_Project_Final_Version_files/unnamed-chunk-26-1.png" width="672"></p>
<p>Most acoustic variables do not appear to be correlated with song
popularity. However a few possible relationships are apparent:</p>
<ul>
<li>Danceability is positively correlated with popularity</li>
<li>Duration is negatively correlated with popularity</li>
<li>Loudness is positively correlated with popularity</li>
<li>Speachiness is negatively correlated with popularity</li>
</ul>
<p>Pearson Correlation Coefficients:</p>
<pre class="r"><code class="hljs">cor.res &lt;- songs_combined[, c(<span class="hljs-number">4</span>, <span class="hljs-number">5</span>:<span class="hljs-number">6</span>, <span class="hljs-number">8</span>, <span class="hljs-number">10</span>:<span class="hljs-number">16</span>)] %&gt;%
    cor_test(Popularity, method = <span class="hljs-string">"pearson"</span>)

cor.res$FDR &lt;- qvalue::qvalue(cor.res$p, pi0 = <span class="hljs-number">1</span>)$qvalues

cor.res</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["var1"],"name":[1],"type":["chr"],"align":["left"]},{"label":["var2"],"name":[2],"type":["chr"],"align":["left"]},{"label":["cor"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["statistic"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["p"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["conf.low"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["conf.high"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["method"],"name":[8],"type":["chr"],"align":["left"]},{"label":["FDR"],"name":[9],"type":["dbl"],"align":["right"]}],"data":[{"1":"Popularity","2":"Danceability","3":"0.160","4":"120.99983","5":"0.00e+00","6":"0.15451747","7":"0.15954154","8":"Pearson","9":"0.00e+00"},{"1":"Popularity","2":"Energy","3":"0.230","4":"182.85409","5":"0.00e+00","6":"0.23119803","7":"0.23606794","8":"Pearson","9":"0.00e+00"},{"1":"Popularity","2":"Loudness","3":"0.320","4":"259.88232","5":"0.00e+00","6":"0.32087106","7":"0.32548414","8":"Pearson","9":"0.00e+00"},{"1":"Popularity","2":"Speachiness","3":"-0.180","4":"-138.12628","5":"0.00e+00","6":"-0.18108286","7":"-0.17609606","8":"Pearson","9":"0.00e+00"},{"1":"Popularity","2":"Acousticness","3":"-0.230","4":"-178.77243","5":"0.00e+00","6":"-0.23113438","7":"-0.22625271","8":"Pearson","9":"0.00e+00"},{"1":"Popularity","2":"Instrumentalness","3":"-0.170","4":"-132.08961","5":"0.00e+00","6":"-0.17351793","7":"-0.16851751","8":"Pearson","9":"0.00e+00"},{"1":"Popularity","2":"Liveness","3":"-0.059","4":"-44.82291","5":"0.00e+00","6":"-0.06136512","7":"-0.05623185","8":"Pearson","9":"0.00e+00"},{"1":"Popularity","2":"Valence","3":"0.040","4":"30.16030","5":"1.12e-199","6":"0.03703012","7":"0.04217312","8":"Pearson","9":"1.12e-199"},{"1":"Popularity","2":"Tempo","3":"0.064","4":"48.45812","5":"0.00e+00","6":"0.06098345","7":"0.06611373","8":"Pearson","9":"0.00e+00"},{"1":"Popularity","2":"Duration","3":"-0.069","4":"-52.90121","5":"0.00e+00","6":"-0.07191163","7":"-0.06678532","8":"Pearson","9":"0.00e+00"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<pre class="r"><code class="hljs"><span class="hljs-comment"># cor.res[cor.res$FDR&lt;0.05, c(1:3, 5, 9)] %&gt;% arrange(cor)</span></code></pre>
<p>Plot correlations among all acoustic variables and popularity
(Pearson)</p>
<pre class="r"><code class="hljs">all_cor &lt;- cor(songs_combined[, c(<span class="hljs-number">4</span>, <span class="hljs-number">5</span>:<span class="hljs-number">6</span>, <span class="hljs-number">8</span>, <span class="hljs-number">10</span>:<span class="hljs-number">16</span>)], method = <span class="hljs-string">"pearson"</span>)

corrplot(all_cor, type = <span class="hljs-string">"upper"</span>, order = <span class="hljs-string">"hclust"</span>, tl.col = <span class="hljs-string">"black"</span>, tl.srt = <span class="hljs-number">45</span>)</code></pre>
<p><img src="./Final_Project_Final_Version_files/unnamed-chunk-28-1.png" width="672"></p>
<div style="page-break-after: always;"></div>
</div>
</div>
<div id="section-modeling-analysis" class="section level2">
<h2>Modeling Analysis</h2>
<p>Using the whole dataset, the models take too long to run. With
greater computational resources, the models can be run on the entire
dataset. For the purposes of this project, the models were run on a
smaller subset of rows selected randomly from the whole data.</p>
<pre class="r"><code class="hljs">set.seed(<span class="hljs-number">1221</span>)
obs &lt;- sample(<span class="hljs-number">1</span>:nrow(songs_combined), <span class="hljs-number">80000</span>)
subdata &lt;- songs_combined[obs, ]</code></pre>
<p>The data was then divided into a training set and a testing set in an
80%/20% split, respectively.</p>
<div id="section-regression-models" class="section level3">
<h3>Regression models</h3>
<p>For the regression analysis, the response variable is
<em>Popularity</em>. The predictors are listed as follows:</p>
<ul>
<li>acousticness</li>
<li>danceability</li>
<li>durations</li>
<li>energy</li>
<li>instrumentalness</li>
<li>key</li>
<li>liveness</li>
<li>loudness</li>
<li>mode</li>
<li>speechiness</li>
<li>tempo</li>
<li>valence</li>
</ul>
<p>The following models were processed using the predictors listed above
in the training data, and model predictions were evaluated against the
testing data. The metrics used to evaluate model fit were root mean
squared error (RMSE) and <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-3-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-21" style="width: 1.432em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.193em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.134em, 1001.19em, 2.324em, -999.997em); top: -2.14em; left: 0em;"><span class="mrow" id="MathJax-Span-22"><span class="msubsup" id="MathJax-Span-23"><span style="display: inline-block; position: relative; width: 1.193em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.78em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="mi" id="MathJax-Span-24" style="font-family: MathJax_Math-italic;">R</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.777em;"><span class="mn" id="MathJax-Span-25" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>R</mi><mn>2</mn></msup></math></span></span><script type="math/tex" id="MathJax-Element-3">R^2</script></span>. A
good model fit will have a lower RMSE and a higher <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-4-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-26" style="width: 1.432em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.193em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.134em, 1001.19em, 2.324em, -999.997em); top: -2.14em; left: 0em;"><span class="mrow" id="MathJax-Span-27"><span class="msubsup" id="MathJax-Span-28"><span style="display: inline-block; position: relative; width: 1.193em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.78em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="mi" id="MathJax-Span-29" style="font-family: MathJax_Math-italic;">R</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.777em;"><span class="mn" id="MathJax-Span-30" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>R</mi><mn>2</mn></msup></math></span></span><script type="math/tex" id="MathJax-Element-4">R^2</script></span> value. Model parameters were then
tuned to try to optimize the model to obtain a better fit.</p>
<pre class="r"><code class="hljs">reg_train &lt;- train[, <span class="hljs-number">4</span>:<span class="hljs-number">16</span>]
reg_test &lt;- test[, <span class="hljs-number">4</span>:<span class="hljs-number">16</span>]
reg_test_x &lt;- reg_test[, -<span class="hljs-number">1</span>]
reg_test_y &lt;- as.matrix(reg_test[, <span class="hljs-number">1</span>], nrow = nrow(reg_test[, <span class="hljs-number">1</span>]), ncol = <span class="hljs-number">1</span>)</code></pre>
<div id="section-random-forest" class="section level4">
<h4>1) Random Forest</h4>
<p>The random forest model is an ensemble learning method that
constructs decision trees with a random selection of a subset of the
predictors. The number of predictors selected for this subset is a
parameter in this model known as mtry. For regression, the output of the
random forest is the number selected by the majority of the trees based
on the predictor values. The initial random forest model that was run
included the default mtry parameter = 3 using 500 trees. The resulting
RMSE and <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-5-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-31" style="width: 1.432em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.193em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.134em, 1001.19em, 2.324em, -999.997em); top: -2.14em; left: 0em;"><span class="mrow" id="MathJax-Span-32"><span class="msubsup" id="MathJax-Span-33"><span style="display: inline-block; position: relative; width: 1.193em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.78em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="mi" id="MathJax-Span-34" style="font-family: MathJax_Math-italic;">R</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.777em;"><span class="mn" id="MathJax-Span-35" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>R</mi><mn>2</mn></msup></math></span></span><script type="math/tex" id="MathJax-Element-5">R^2</script></span> values evaluated
against the testing data were 14.99 and 0.254, respectively.</p>
<p>The random forest model was then tuned via 5-fold cross validation to
determine the optimal value of mtry. Since there are 12 predictors, the
model was re-run using mtry values ranging from 2-12, and the model that
had the lowest RMSE was selected as the optimal model. The model with
mtry = 3 had the lowest RMSE, so our initial model was already the
optimal model.</p>
<pre class="r"><code class="hljs"><span class="hljs-comment"># Fit random forest regression model</span>
rf_reg_fit &lt;- ranger(Popularity ~ ., data = reg_train, importance = <span class="hljs-string">"impurity"</span>)
rf_reg_fit
<span class="hljs-comment"># Function that computes RMSE and R^2 from true and predicted values</span>
eval_results &lt;- <span class="hljs-keyword">function</span>(true, predicted, df) {
    SSE &lt;- sum((predicted - true)^<span class="hljs-number">2</span>)
    SST &lt;- sum((true - mean(true))^<span class="hljs-number">2</span>)
    R_square &lt;- <span class="hljs-number">1</span> - SSE/SST
    RMSE &lt;- sqrt(SSE/nrow(df))
    <span class="hljs-comment"># Summarize model performance metrics</span>
    data.frame(RMSE &lt;- RMSE, Rsquare &lt;- R_square)
}
<span class="hljs-comment"># Prediction and evaluation on test data</span>
rf_reg_pred_y &lt;- predict(rf_reg_fit, reg_test_x)

rf_reg_res &lt;- eval_results(as.matrix(reg_test[, <span class="hljs-number">1</span>]), rf_reg_pred_y$predictions, as.matrix(reg_test))

<span class="hljs-comment"># Get variable importance from the model fit</span>
importance &lt;- as.vector(rf_reg_fit$variable.importance)
variable &lt;- as.vector(colnames(reg_train)[<span class="hljs-number">2</span>:<span class="hljs-number">13</span>])
var_imp &lt;- cbind(variable, importance)
var_imp &lt;- as.data.frame(var_imp)
var_imp$importance &lt;- as.numeric(var_imp$importance)
var_imp

ggplot(var_imp, aes(x = reorder(variable, importance), y = importance, fill = importance)) +
    geom_bar(stat = <span class="hljs-string">"identity"</span>, position = <span class="hljs-string">"dodge"</span>) + coord_flip() + ylab(<span class="hljs-string">"Variable Importance"</span>) +
    xlab(<span class="hljs-string">""</span>) + ggtitle(<span class="hljs-string">"Variable Importance Plot"</span>)

<span class="hljs-comment"># Tune mtry parameter (# of vars to randomly sample as candidates at each</span>
<span class="hljs-comment"># split)</span>
rf_grid &lt;- expand.grid(mtry = c(<span class="hljs-number">2</span>:<span class="hljs-number">12</span>), splitrule = <span class="hljs-string">"variance"</span>, min.node.size = <span class="hljs-number">5</span>)

fitControl &lt;- trainControl(method = <span class="hljs-string">"CV"</span>, number = <span class="hljs-number">5</span>, verboseIter = <span class="hljs-literal">TRUE</span>)

class(reg_train$Popularity)

<span class="hljs-comment">## below does not work</span>

rf_reg_tune &lt;- train(x = reg_train[, <span class="hljs-number">2</span>:<span class="hljs-number">13</span>], y = reg_train[, <span class="hljs-number">1</span>], method = <span class="hljs-string">"ranger"</span>,
    tuneGrid = rf_grid, metric = <span class="hljs-string">"RMSE"</span>, trControl = fitControl)
rf_reg_tune

plot(rf_reg_tune$results[, <span class="hljs-number">1</span>], rf_reg_tune$results[, <span class="hljs-number">4</span>], xlab = <span class="hljs-string">"Mtry"</span>, ylab = <span class="hljs-string">"RMSE"</span>,
    type = <span class="hljs-string">"l"</span>)</code></pre>
<p><img src="./Final_Project_Final_Version_files/rf_reg_mtry.png"></p>
</div>
<div id="section-gradient-boosting-machine" class="section level4">
<h4>2) Gradient Boosting Machine</h4>
<p>Gradient boosting machines (GBM) are another type of ensemble machine
learning algorithms that can be used for regression. Gradient boosting
is an optimization problem with the goal of minimizing the model’s loss
by adding one weak learner at a time using a gradient descent algorithm.
The weak learners in gradient boosting are decision trees. The decision
trees are built such that their split values are determined based on
minimizing the loss. The GBM that was run included the default max tree
depth parameter = 3 and number of iterations parameter = 150. The
resulting RMSE and <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-6-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-36" style="width: 1.432em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.193em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.134em, 1001.19em, 2.324em, -999.997em); top: -2.14em; left: 0em;"><span class="mrow" id="MathJax-Span-37"><span class="msubsup" id="MathJax-Span-38"><span style="display: inline-block; position: relative; width: 1.193em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.78em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="mi" id="MathJax-Span-39" style="font-family: MathJax_Math-italic;">R</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.777em;"><span class="mn" id="MathJax-Span-40" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>R</mi><mn>2</mn></msup></math></span></span><script type="math/tex" id="MathJax-Element-6">R^2</script></span> values
evaluated against the testing data were 15.28 and 0.225,
respectively.</p>
<p>The GBM was then tuned via 5-fold cross validation to determine the
optimal parameter values. The max tree depth values that were tested
were 1, 5, and 9, and the number of iterations tested ranged from 50 to
1000 by increments of 50. The model with max tree depth = 9 and number
of iterations = 400 had the lowest RMSE, so the GBM was re-run using
these parameters. The resulting RMSE and <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-7-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-41" style="width: 1.432em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.193em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.134em, 1001.19em, 2.324em, -999.997em); top: -2.14em; left: 0em;"><span class="mrow" id="MathJax-Span-42"><span class="msubsup" id="MathJax-Span-43"><span style="display: inline-block; position: relative; width: 1.193em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.78em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="mi" id="MathJax-Span-44" style="font-family: MathJax_Math-italic;">R</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.777em;"><span class="mn" id="MathJax-Span-45" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>R</mi><mn>2</mn></msup></math></span></span><script type="math/tex" id="MathJax-Element-7">R^2</script></span> values were 15.07 and 0.245,
respectively.</p>
<pre class="r"><code class="hljs"><span class="hljs-comment"># Fit GBM</span>
gbm_reg_fit &lt;- train(Popularity ~ ., data = reg_train, method = <span class="hljs-string">"gbm"</span>, trControl = fitControl,
    verbose = <span class="hljs-literal">FALSE</span>)

gbm_reg_fit
<span class="hljs-comment"># Prediction and evaluation on test data</span>
gbm_reg_pred_y &lt;- predict(gbm_reg_fit, reg_test_x)

gbm_reg_res &lt;- eval_results(as.matrix(reg_test[, <span class="hljs-number">1</span>]), gbm_reg_pred_y, as.matrix(reg_test))

<span class="hljs-comment"># Tune interaction.depth (tree complexity) and n.trees (# of iterations)</span>
<span class="hljs-comment"># parameters</span>
gbm_grid &lt;- expand.grid(interaction.depth = c(<span class="hljs-number">1</span>, <span class="hljs-number">5</span>, <span class="hljs-number">9</span>), n.trees = (<span class="hljs-number">1</span>:<span class="hljs-number">20</span>) * <span class="hljs-number">50</span>, shrinkage = <span class="hljs-number">0.1</span>,
    n.minobsinnode = <span class="hljs-number">20</span>)

gbm_reg_tune &lt;- train(Popularity ~ ., data = reg_train, method = <span class="hljs-string">"gbm"</span>, trControl = fitControl,
    verbose = <span class="hljs-literal">FALSE</span>, tuneGrid = gbm_grid)

gbm_reg_tune

plot(gbm_reg_tune)

gbm_grid_tune &lt;- expand.grid(interaction.depth = <span class="hljs-number">9</span>, n.trees = <span class="hljs-number">400</span>, shrinkage = <span class="hljs-number">0.1</span>,
    n.minobsinnode = <span class="hljs-number">20</span>)

gbm_reg_tuned_fit &lt;- train(Popularity ~ ., data = reg_train, method = <span class="hljs-string">"gbm"</span>, trControl = fitControl,
    verbose = <span class="hljs-literal">FALSE</span>, tuneGrid = gbm_grid_tune)

gbm_reg_tuned_fit
<span class="hljs-comment"># Tuned prediction and evaluation on test data</span>
gbm_reg_tuned_pred_y &lt;- predict(gbm_reg_tuned_fit, reg_test_x)

gbm_reg_tuned_res &lt;- eval_results(as.matrix(reg_test[, <span class="hljs-number">1</span>]), gbm_reg_tuned_pred_y,
    as.matrix(reg_test))</code></pre>
<p><img src="./Final_Project_Final_Version_files/gbm_reg_int_depth_iter.png"></p>
</div>
<div id="section-support-vector-regression" class="section level4">
<h4>3) Support Vector Regression</h4>
<p>Support vector machines (SVM) are large margin classifiers. Support
vector regression is a machine learning algorithm that finds an
appropriate line or hyperplane that fits the data within a specified
threshold. Here, we are fitting a linear kernel. The support vector
regression model that was run included the default cost parameter = 1.
This cost parameter can adjust for how much the large margin
classification should be. The resulting RMSE and <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-8-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-46" style="width: 1.432em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.193em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.134em, 1001.19em, 2.324em, -999.997em); top: -2.14em; left: 0em;"><span class="mrow" id="MathJax-Span-47"><span class="msubsup" id="MathJax-Span-48"><span style="display: inline-block; position: relative; width: 1.193em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.78em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="mi" id="MathJax-Span-49" style="font-family: MathJax_Math-italic;">R</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.777em;"><span class="mn" id="MathJax-Span-50" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>R</mi><mn>2</mn></msup></math></span></span><script type="math/tex" id="MathJax-Element-8">R^2</script></span> values were 15.98 and 0.152,
respectively.</p>
<p>The support vector regression was then tuned via 5-fold cross
validation to determine the optimal cost parameter. The cost values that
were tested were 0.25, 0.5, and 1. The model with cost = 0.25 had the
lowest RMSE, so the support vector regression was re-run using this
parameter value. The resulting RMSE and <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-9-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-51" style="width: 1.432em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.193em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.134em, 1001.19em, 2.324em, -999.997em); top: -2.14em; left: 0em;"><span class="mrow" id="MathJax-Span-52"><span class="msubsup" id="MathJax-Span-53"><span style="display: inline-block; position: relative; width: 1.193em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.78em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="mi" id="MathJax-Span-54" style="font-family: MathJax_Math-italic;">R</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.777em;"><span class="mn" id="MathJax-Span-55" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>R</mi><mn>2</mn></msup></math></span></span><script type="math/tex" id="MathJax-Element-9">R^2</script></span> values were 15.98 and 0.152,
respectively.</p>
<pre class="r"><code class="hljs"><span class="hljs-comment"># Fit support vector regression</span>
svm_reg_fit &lt;- train(Popularity ~ ., data = reg_train, method = <span class="hljs-string">"svmLinear"</span>, trControl = fitControl,
    preProcess = c(<span class="hljs-string">"center"</span>, <span class="hljs-string">"scale"</span>))

svm_reg_fit

<span class="hljs-comment"># Prediction and evaluation on test data</span>
svm_reg_pred_y &lt;- predict(svm_reg_fit, reg_test_x)

svm_reg_res &lt;- eval_results(as.matrix(reg_test[, <span class="hljs-number">1</span>]), svm_reg_pred_y, as.matrix(reg_test))

<span class="hljs-comment"># Tune C parameter (cost - penalty to model for making error)</span>
svm_grid &lt;- expand.grid(C = c(<span class="hljs-number">0.25</span>, <span class="hljs-number">0.5</span>, <span class="hljs-number">1</span>))

svm_reg_tune &lt;- train(Popularity ~ ., data = reg_train, method = <span class="hljs-string">"svmLinear"</span>, trControl = fitControl,
    preProcess = c(<span class="hljs-string">"center"</span>, <span class="hljs-string">"scale"</span>), tuneGrid = svm_grid)
svm_reg_tune

plot(svm_reg_tune)

svm_grid_tune &lt;- expand.grid(C = <span class="hljs-number">0.25</span>)

svm_reg_tuned_fit &lt;- train(Popularity ~ ., data = reg_train, method = <span class="hljs-string">"svmLinear"</span>,
    trControl = fitControl, preProcess = c(<span class="hljs-string">"center"</span>, <span class="hljs-string">"scale"</span>), tuneGrid = svm_grid_tune)

svm_reg_tuned_fit
<span class="hljs-comment"># Tuned prediction and evaluation on test data</span>
svm_reg_tuned_pred_y &lt;- predict(svm_reg_tuned_fit, reg_test_x)

svm_reg_tuned_res &lt;- eval_results(as.matrix(reg_test[, <span class="hljs-number">1</span>]), svm_reg_tuned_pred_y,
    as.matrix(reg_test))</code></pre>
<p><img src="./Final_Project_Final_Version_files/svm_reg_cost.png"></p>
<div style="page-break-after: always;"></div>
</div>
</div>
<div id="section-classification-models" class="section level3">
<h3>Classification Models</h3>
<pre class="r"><code class="hljs">cl_train &lt;- train[, <span class="hljs-number">5</span>:<span class="hljs-number">17</span>]
cl_test &lt;- test[, <span class="hljs-number">5</span>:<span class="hljs-number">17</span>]
cl_test_x &lt;- cl_test[, -<span class="hljs-number">13</span>]
cl_test_y &lt;- as.matrix(cl_test[, <span class="hljs-number">13</span>], nrow = nrow(cl_test[, <span class="hljs-number">13</span>]), ncol = <span class="hljs-number">1</span>)</code></pre>
<p>For the classification analysis, the response variable is
<em>Popularity_quantized</em>. The predictors remain the same as
regression.</p>
<p>The metric used to evaluate model fit was accuracy. A good model fit
will have a higher accuracy value. Similar to regression, model
parameters were then tuned to try to optimize the model to obtain a
better fit.</p>
<div id="section-random-forest-1" class="section level4">
<h4>1) Random Forest</h4>
<p>The random forest model for classification is similar to the random
forest model for regression except the output of the random forest is
the class selected by the majority of the trees based on the predictor
values. The initial random forest model was run, and the resulting
accuracy evaluated against the testing data was 0.592.</p>
<p>The random forest model was then tuned similar to regression, and the
model with mtry = 3 had the highest accuracy, so our initial model was
already the optimal model again.</p>
<pre class="r"><code class="hljs"><span class="hljs-comment"># Fit random forest regression model</span>
rf_cl_fit &lt;- ranger(Popularity_quantized ~ ., data = cl_train, importance = <span class="hljs-string">"impurity"</span>)
rf_cl_fit
<span class="hljs-comment"># Prediction and evaluation on test data</span>
rf_cl_pred_y &lt;- predict(rf_cl_fit, cl_test_x)
table &lt;- table(rf_cl_pred_y$predictions, cl_test_y)[<span class="hljs-number">1</span>:<span class="hljs-number">4</span>, c(<span class="hljs-number">4</span>, <span class="hljs-number">1</span>:<span class="hljs-number">3</span>)]
table
rf_table &lt;- confusionMatrix(table)
<span class="hljs-comment"># Get variable importance from the model fit</span>
importance &lt;- as.vector(rf_cl_fit$variable.importance)
variable &lt;- as.vector(colnames(cl_train)[<span class="hljs-number">1</span>:<span class="hljs-number">12</span>])
var_imp &lt;- cbind(variable, importance)
var_imp &lt;- as.data.frame(var_imp)
var_imp$importance &lt;- as.numeric(var_imp$importance)
var_imp
ggplot(var_imp, aes(x = reorder(variable, importance), y = importance, fill = importance)) +
    geom_bar(stat = <span class="hljs-string">"identity"</span>, position = <span class="hljs-string">"dodge"</span>) + coord_flip() + ylab(<span class="hljs-string">"Variable Importance"</span>) +
    xlab(<span class="hljs-string">""</span>) + ggtitle(<span class="hljs-string">"Variable Importance Plot"</span>)
<span class="hljs-comment"># Tune mtry parameter (# of vars to randomly sample as candidates at each</span>
<span class="hljs-comment"># split)</span>
rf_grid &lt;- expand.grid(mtry = c(<span class="hljs-number">2</span>:<span class="hljs-number">12</span>), splitrule = <span class="hljs-string">"gini"</span>, min.node.size = <span class="hljs-number">1</span>)
fitControl &lt;- trainControl(method = <span class="hljs-string">"CV"</span>, number = <span class="hljs-number">5</span>, verboseIter = <span class="hljs-literal">TRUE</span>)
rf_cl_tune &lt;- train(x = cl_train[, <span class="hljs-number">1</span>:<span class="hljs-number">12</span>], y = cl_train[, <span class="hljs-number">13</span>], method = <span class="hljs-string">"ranger"</span>,
    tuneGrid = rf_grid, metric = <span class="hljs-string">"Accuracy"</span>, trControl = fitControl)
rf_cl_tune
plot(rf_cl_tune$results[, <span class="hljs-number">1</span>], rf_cl_tune$results[, <span class="hljs-number">4</span>], xlab = <span class="hljs-string">"Mtry"</span>, ylab = <span class="hljs-string">"Accuracy"</span>,
    type = <span class="hljs-string">"l"</span>)
<span class="hljs-comment"># Optimal model is mtry = 3 which is the random forest classification model</span>
<span class="hljs-comment"># that was already run</span></code></pre>
<p><img src="./Final_Project_Final_Version_files/rf_cl_mtry.png"></p>
</div>
<div id="section-gradient-boosting-machine-1" class="section level4">
<h4>2) Gradient Boosting Machine</h4>
<p>GBM can also be used for classification. The initial GBM was run, and
the resulting accuracy evaluated against the testing data was 0.584.</p>
<p>The GBM was then tuned similar to regression, and the model with max
tree depth = 9 and number of iterations = 100 had the lowest accuracy,
so the GBM was re-run using these parameters. The resulting accuracy was
0.590.</p>
<pre class="r"><code class="hljs"><span class="hljs-comment"># Fit GBM</span>
gbm_cl_fit &lt;- train(Popularity_quantized ~ ., data = cl_train, method = <span class="hljs-string">"gbm"</span>, trControl = fitControl,
    verbose = <span class="hljs-literal">FALSE</span>)
gbm_cl_fit
<span class="hljs-comment"># Prediction and evaluation on test data</span>
gbm_cl_pred_y &lt;- predict(gbm_cl_fit, cl_test_x)
table &lt;- table(gbm_cl_pred_y, cl_test_y)[<span class="hljs-number">1</span>:<span class="hljs-number">4</span>, c(<span class="hljs-number">4</span>, <span class="hljs-number">1</span>:<span class="hljs-number">3</span>)]
table
gbm_table &lt;- confusionMatrix(table)
<span class="hljs-comment"># Tune interaction.depth (tree complexity) and n.trees (# of iterations)</span>
<span class="hljs-comment"># parameters</span>
gbm_grid &lt;- expand.grid(interaction.depth = c(<span class="hljs-number">1</span>, <span class="hljs-number">5</span>, <span class="hljs-number">9</span>), n.trees = (<span class="hljs-number">1</span>:<span class="hljs-number">20</span>) * <span class="hljs-number">50</span>, shrinkage = <span class="hljs-number">0.1</span>,
    n.minobsinnode = <span class="hljs-number">20</span>)
gbm_cl_tune &lt;- train(Popularity_quantized ~ ., data = cl_train, method = <span class="hljs-string">"gbm"</span>, trControl = fitControl,
    verbose = <span class="hljs-literal">FALSE</span>, tuneGrid = gbm_grid)
gbm_cl_tune
plot(gbm_cl_tune)
gbm_grid_tune &lt;- expand.grid(interaction.depth = <span class="hljs-number">9</span>, n.trees = <span class="hljs-number">100</span>, shrinkage = <span class="hljs-number">0.1</span>,
    n.minobsinnode = <span class="hljs-number">20</span>)
gbm_cl_tuned_fit &lt;- train(Popularity_quantized ~ ., data = cl_train, method = <span class="hljs-string">"gbm"</span>,
    trControl = fitControl, verbose = <span class="hljs-literal">FALSE</span>, tuneGrid = gbm_grid_tune)
gbm_cl_tuned_fit
<span class="hljs-comment"># Tuned prediction and evaluation on test data</span>
gbm_cl_tuned_pred_y &lt;- predict(gbm_cl_tuned_fit, cl_test_x)
table &lt;- table(gbm_cl_tuned_pred_y, cl_test_y)[<span class="hljs-number">1</span>:<span class="hljs-number">4</span>, c(<span class="hljs-number">4</span>, <span class="hljs-number">1</span>:<span class="hljs-number">3</span>)]
table
gbm_tuned_table &lt;- confusionMatrix(table)</code></pre>
<p><img src="./Final_Project_Final_Version_files/gbm_cl_int_depth_iter.png"></p>
</div>
<div id="section-support-vector-machine" class="section level4">
<h4>3) Support Vector Machine</h4>
<p>SVM was used for classification. Here it tries to find an appropriate
margin that separates the classes and also reduces the risk of error on
the data. A linear classifier was used similar to regression. The
initial SVM model was run, and the resulting accuracy evaluated against
the testing data was 0.572.</p>
<p>The SVM model was then tuned similar to regression, and the model
with cost = 1 had the highest accuracy, so our initial model was already
the optimal model.</p>
<pre class="r"><code class="hljs"><span class="hljs-comment"># Fit support vector regression</span>
svm_cl_fit &lt;- train(Popularity_quantized ~ ., data = cl_train, method = <span class="hljs-string">"svmLinear"</span>,
    trControl = fitControl, preProcess = c(<span class="hljs-string">"center"</span>, <span class="hljs-string">"scale"</span>))
svm_cl_fit
<span class="hljs-comment"># Prediction and evaluation on test data</span>
svm_cl_pred_y &lt;- predict(svm_cl_fit, cl_test_x)
table &lt;- table(svm_cl_pred_y, cl_test_y)[<span class="hljs-number">1</span>:<span class="hljs-number">4</span>, c(<span class="hljs-number">4</span>, <span class="hljs-number">1</span>:<span class="hljs-number">3</span>)]
table
svm_table &lt;- confusionMatrix(table)
<span class="hljs-comment"># Tune C parameter (cost - penalty to model for making error)</span>
svm_grid &lt;- expand.grid(C = c(<span class="hljs-number">0.25</span>, <span class="hljs-number">0.5</span>, <span class="hljs-number">1</span>))
svm_cl_tune &lt;- train(Popularity_quantized ~ ., data = cl_train, method = <span class="hljs-string">"svmLinear"</span>,
    trControl = fitControl, preProcess = c(<span class="hljs-string">"center"</span>, <span class="hljs-string">"scale"</span>), tuneGrid = svm_grid)
svm_cl_tune
plot(svm_cl_tune)
<span class="hljs-comment"># Optimal model is C = 1 which is the svm classification model that was already</span>
<span class="hljs-comment"># run</span></code></pre>
<p><img src="./Final_Project_Final_Version_files/svm_cl_cost.png"></p>
<div style="page-break-after: always;"></div>
</div>
</div>
</div>
<div id="section-results" class="section level2">
<h2>Results</h2>
<p>Below is a summary table of the regression and classification model
metrics. The random forest model appears to perform the best for both
regression and classification because it has the lowest RMSE and highest
accuracy, respectively. This means it is a good model to predict both a
popularity score as well as a popularity class given these
predictors.</p>
<p>On the other hand, the SVM model appears to perform the worst for
both regression and classification. This suggests a linear classifier
may not be good enough to predict popularity. However, the model metrics
are still pretty close to each other and aren’t too far apart. Given
more time, we could look into other possible kernels for SVM such as a
polynomial or radial kernel, for example, to better match the shape of
the data. We could also look into tuning other parameters in the random
forest model such as the number of trees parameter to further improve
the model fit.</p>
<pre class="r"><code class="hljs"><span class="hljs-comment"># Make a table of regression results</span>
tab &lt;- matrix(c(round(rf_reg_res, <span class="hljs-number">3</span>), round(rf_reg_res, <span class="hljs-number">3</span>), round(gbm_reg_res, <span class="hljs-number">3</span>),
    round(gbm_reg_tuned_res, <span class="hljs-number">3</span>), round(svm_reg_res, <span class="hljs-number">3</span>), round(svm_reg_tuned_res,
        <span class="hljs-number">3</span>)), nrow = <span class="hljs-number">6</span>, ncol = <span class="hljs-number">2</span>, byrow = <span class="hljs-literal">TRUE</span>)
rownames(tab) &lt;- c(<span class="hljs-string">"Random Forest"</span>, <span class="hljs-string">"Random Forest Tuned"</span>, <span class="hljs-string">"GBM"</span>, <span class="hljs-string">"GBM Tuned"</span>, <span class="hljs-string">"SVM"</span>,
    <span class="hljs-string">"SVM Tuned"</span>)
colnames(tab) &lt;- c(<span class="hljs-string">"RMSE"</span>, <span class="hljs-string">"R^2"</span>)
tab</code></pre>
<pre class="r"><code class="hljs"><span class="hljs-comment"># Make a table of classification results</span>
tab &lt;- matrix(c(round(rf_table$overall[<span class="hljs-number">1</span>], <span class="hljs-number">3</span>), round(rf_table$overall[<span class="hljs-number">1</span>], <span class="hljs-number">3</span>), round(gbm_table$overall[<span class="hljs-number">1</span>],
    <span class="hljs-number">3</span>), round(gbm_tuned_table$overall[<span class="hljs-number">1</span>], <span class="hljs-number">3</span>), round(svm_table$overall[<span class="hljs-number">1</span>], <span class="hljs-number">3</span>), round(svm_table$overall[<span class="hljs-number">1</span>],
    <span class="hljs-number">3</span>)), nrow = <span class="hljs-number">6</span>, ncol = <span class="hljs-number">1</span>, byrow = <span class="hljs-literal">TRUE</span>)
rownames(tab) &lt;- c(<span class="hljs-string">"Random Forest"</span>, <span class="hljs-string">"Random Forest Tuned"</span>, <span class="hljs-string">"GBM"</span>, <span class="hljs-string">"GBM Tuned"</span>, <span class="hljs-string">"SVM"</span>,
    <span class="hljs-string">"SVM Tuned"</span>)
colnames(tab) &lt;- c(<span class="hljs-string">"Accuracy"</span>)
tab</code></pre>
<p>Summary statistics for regression models:</p>
<p><img src="./Final_Project_Final_Version_files/reg_summary.png"> Summary statistics for classification
models:</p>
<p><img src="./Final_Project_Final_Version_files/cl_summary.png"></p>
<p>Here’s a breakdown of the importance of each of the predictors from
the random forest model for both regression and classification. The
plots are similar except for the small discrepancy in the order of
importance for <em>Energy</em> and <em>Speachiness</em>.</p>
<p>The variable that has the most impact in predicting song popularity
is <em>loudness</em> with a huge margin. <em>Key</em> and <em>Mode</em>
have the least impact in predicting song popularity. This makes sense
because the average person would not normally know the key or mode of a
song.</p>
<div id="section-regression" class="section level4">
<h4>Regression</h4>
<p><img src="./Final_Project_Final_Version_files/rf_reg_varimp.png"></p>
</div>
<div id="section-classification" class="section level4">
<h4>Classification</h4>
<p><img src="./Final_Project_Final_Version_files/rf_cl_varimp.png"></p>
</div>
</div>
<div id="section-conclusion" class="section level2">
<h2>Conclusion</h2>
<p>In summary our project accomplishes two objectives. First, we were
able to create novel date using a combination of python, bash and R
packages we learned throughout the semester. Second, we completed an
exploratory and machine learning analysis on our novel dataset to
understand what parameters of songs predict popularity. From our
analysis we found that loudness was by far the best predictor of song
popularity, followed by speechiness, energy and duration. While we don’t
intend to make any theoretical argument for these predictors they seem
to make sense if we consider that one way (but certainly not the only
way) music popularity spreads is radio play and songs that are loud,
have lyrics and are not twelve minutes long tend to get radio time.</p>
</div>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("section-TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "mathjax-local/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>


</div>
  </div>


<div id="j_c_asin" style="color: initial; font: initial; font-feature-settings: initial; font-kerning: initial; font-optical-sizing: initial; font-palette: initial; font-synthesis: initial; font-variation-settings: initial; forced-color-adjust: initial; text-orientation: initial; text-rendering: initial; -webkit-font-smoothing: initial; -webkit-locale: initial; -webkit-text-orientation: initial; -webkit-writing-mode: initial; writing-mode: initial; zoom: initial; accent-color: initial; place-content: initial; place-items: initial; place-self: initial; alignment-baseline: initial; animation: initial; app-region: initial; appearance: initial; aspect-ratio: initial; backdrop-filter: initial; backface-visibility: initial; background: initial; background-blend-mode: initial; baseline-shift: initial; block-size: initial; border-block: initial; border: initial; border-radius: initial; border-collapse: initial; border-end-end-radius: initial; border-end-start-radius: initial; border-inline: initial; border-start-end-radius: initial; border-start-start-radius: initial; inset: initial; box-shadow: initial; box-sizing: initial; break-after: initial; break-before: initial; break-inside: initial; buffered-rendering: initial; caption-side: initial; caret-color: initial; clear: initial; clip: initial; clip-path: initial; clip-rule: initial; color-interpolation: initial; color-interpolation-filters: initial; color-rendering: initial; color-scheme: initial; columns: initial; column-fill: initial; gap: initial; column-rule: initial; column-span: initial; contain: initial; contain-intrinsic-block-size: initial; contain-intrinsic-size: initial; contain-intrinsic-inline-size: initial; container: initial; content: initial; content-visibility: initial; counter-increment: initial; counter-reset: initial; counter-set: initial; cursor: initial; cx: initial; cy: initial; d: initial; display: initial; dominant-baseline: initial; empty-cells: initial; fill: initial; fill-opacity: initial; fill-rule: initial; filter: initial; flex: initial; flex-flow: initial; float: initial; flood-color: initial; flood-opacity: initial; grid: initial; grid-area: initial; height: initial; hyphenate-character: initial; hyphens: initial; image-orientation: initial; image-rendering: initial; inline-size: initial; inset-block: initial; inset-inline: initial; isolation: initial; letter-spacing: initial; lighting-color: initial; line-break: initial; list-style: initial; margin-block: initial; margin: initial; margin-inline: initial; marker: initial; mask: initial; mask-type: initial; max-block-size: initial; max-height: initial; max-inline-size: initial; max-width: initial; min-block-size: initial; min-height: initial; min-inline-size: initial; min-width: initial; mix-blend-mode: initial; object-fit: initial; object-position: initial; object-view-box: initial; offset: initial; opacity: initial; order: initial; origin-trial-test-property: initial; orphans: initial; outline: initial; outline-offset: initial; overflow-anchor: initial; overflow-clip-margin: initial; overflow-wrap: initial; overflow: initial; overscroll-behavior-block: initial; overscroll-behavior-inline: initial; overscroll-behavior: initial; padding-block: initial; padding: initial; padding-inline: initial; page: initial; page-orientation: initial; paint-order: initial; perspective: initial; perspective-origin: initial; pointer-events: initial; position: relative; quotes: initial; r: initial; resize: initial; rotate: initial; ruby-position: initial; rx: initial; ry: initial; scale: initial; scroll-behavior: initial; scroll-margin-block: initial; scroll-margin: initial; scroll-margin-inline: initial; scroll-padding-block: initial; scroll-padding: initial; scroll-padding-inline: initial; scroll-snap-align: initial; scroll-snap-stop: initial; scroll-snap-type: initial; scrollbar-gutter: initial; shape-image-threshold: initial; shape-margin: initial; shape-outside: initial; shape-rendering: initial; size: initial; speak: initial; stop-color: initial; stop-opacity: initial; stroke: initial; stroke-dasharray: initial; stroke-dashoffset: initial; stroke-linecap: initial; stroke-linejoin: initial; stroke-miterlimit: initial; stroke-opacity: initial; stroke-width: initial; tab-size: initial; table-layout: initial; text-align: initial; text-align-last: initial; text-anchor: initial; text-combine-upright: initial; text-decoration: initial; text-decoration-skip-ink: initial; text-emphasis: initial; text-emphasis-position: initial; text-indent: initial; text-overflow: initial; text-shadow: initial; text-size-adjust: initial; text-transform: initial; text-underline-offset: initial; text-underline-position: initial; touch-action: initial; transform: initial; transform-box: initial; transform-origin: initial; transform-style: initial; transition: initial; translate: initial; user-select: initial; vector-effect: initial; vertical-align: initial; visibility: initial; border-spacing: initial; -webkit-box-align: initial; -webkit-box-decoration-break: initial; -webkit-box-direction: initial; -webkit-box-flex: initial; -webkit-box-ordinal-group: initial; -webkit-box-orient: initial; -webkit-box-pack: initial; -webkit-box-reflect: initial; -webkit-highlight: initial; -webkit-line-break: initial; -webkit-line-clamp: initial; -webkit-mask-box-image: initial; -webkit-mask: initial; -webkit-mask-composite: initial; -webkit-print-color-adjust: initial; -webkit-rtl-ordering: initial; -webkit-ruby-position: initial; -webkit-tap-highlight-color: initial; -webkit-text-combine: initial; -webkit-text-decorations-in-effect: initial; -webkit-text-fill-color: initial; -webkit-text-security: initial; -webkit-text-stroke: initial; -webkit-user-drag: initial; -webkit-user-modify: initial; white-space: initial; widows: initial; width: initial; will-change: initial; word-break: initial; word-spacing: initial; x: initial; y: initial; z-index: 2147483647;"><style type="text/css">16580@font-face{font-family:"Roboto";src:url(chrome-extension://emalgedpdlghbkikiaeocoblajamonoh/fonts/Roboto/roboto-100.woff) format("woff"),url(chrome-extension://emalgedpdlghbkikiaeocoblajamonoh/fonts/Roboto/roboto-100.woff2) format("woff2"),url(chrome-extension://emalgedpdlghbkikiaeocoblajamonoh/fonts/Roboto/roboto-100.ttf) format("truetype");font-style:normal;font-weight:100;font-display:swap}@font-face{font-family:"Roboto";src:url(chrome-extension://emalgedpdlghbkikiaeocoblajamonoh/fonts/Roboto/roboto-300.woff) format("woff"),url(chrome-extension://emalgedpdlghbkikiaeocoblajamonoh/fonts/Roboto/roboto-300.woff2) format("woff2"),url(chrome-extension://emalgedpdlghbkikiaeocoblajamonoh/fonts/Roboto/roboto-300.ttf) format("truetype");font-style:normal;font-weight:300;font-display:swap}@font-face{font-family:"Roboto";src:url(chrome-extension://emalgedpdlghbkikiaeocoblajamonoh/fonts/Roboto/roboto-400.woff) format("woff"),url(chrome-extension://emalgedpdlghbkikiaeocoblajamonoh/fonts/Roboto/roboto-400.woff2) format("woff2"),url(chrome-extension://emalgedpdlghbkikiaeocoblajamonoh/fonts/Roboto/roboto-400.ttf) format("truetype");font-style:normal;font-weight:400;font-display:swap}@font-face{font-family:"Roboto";src:url(chrome-extension://emalgedpdlghbkikiaeocoblajamonoh/fonts/Roboto/roboto-500.woff) format("woff"),url(chrome-extension://emalgedpdlghbkikiaeocoblajamonoh/fonts/Roboto/roboto-500.woff2) format("woff2"),url(chrome-extension://emalgedpdlghbkikiaeocoblajamonoh/fonts/Roboto/roboto-500.ttf) format("truetype");font-style:normal;font-weight:500;font-display:swap}@font-face{font-family:"Roboto";src:url(chrome-extension://emalgedpdlghbkikiaeocoblajamonoh/fonts/Roboto/roboto-700.woff) format("woff"),url(chrome-extension://emalgedpdlghbkikiaeocoblajamonoh/fonts/Roboto/roboto-700.woff2) format("woff2"),url(chrome-extension://emalgedpdlghbkikiaeocoblajamonoh/fonts/Roboto/roboto-700.ttf) format("truetype");font-style:normal;font-weight:700;font-display:swap}@font-face{font-family:"Roboto";src:url(chrome-extension://emalgedpdlghbkikiaeocoblajamonoh/fonts/Roboto/roboto-900.woff) format("woff"),url(chrome-extension://emalgedpdlghbkikiaeocoblajamonoh/fonts/Roboto/roboto-900.woff2) format("woff2"),url(chrome-extension://emalgedpdlghbkikiaeocoblajamonoh/fonts/Roboto/roboto-900.ttf) format("truetype");font-style:normal;font-weight:900;font-display:swap}@font-face{font-family:"Rebond";src:url(chrome-extension://emalgedpdlghbkikiaeocoblajamonoh/fonts/Rebond/rebond-400.woff) format("woff"),url(chrome-extension://emalgedpdlghbkikiaeocoblajamonoh/fonts/Rebond/rebond-400.woff2) format("woff2"),url(chrome-extension://emalgedpdlghbkikiaeocoblajamonoh/fonts/Rebond/rebond-400.ttf) format("truetype");font-style:normal;font-weight:400;font-display:swap}@font-face{font-family:"Rebond";src:url(chrome-extension://emalgedpdlghbkikiaeocoblajamonoh/fonts/Rebond/rebond-500.woff) format("woff"),url(chrome-extension://emalgedpdlghbkikiaeocoblajamonoh/fonts/Rebond/rebond-500.woff2) format("woff2"),url(chrome-extension://emalgedpdlghbkikiaeocoblajamonoh/fonts/Rebond/rebond-500.ttf) format("truetype");font-style:normal;font-weight:500;font-display:swap}@font-face{font-family:"Rebond";src:url(chrome-extension://emalgedpdlghbkikiaeocoblajamonoh/fonts/Rebond/rebond-600.woff) format("woff"),url(chrome-extension://emalgedpdlghbkikiaeocoblajamonoh/fonts/Rebond/rebond-600.woff2) format("woff2"),url(chrome-extension://emalgedpdlghbkikiaeocoblajamonoh/fonts/Rebond/rebond-600.ttf) format("truetype");font-style:normal;font-weight:600;font-display:swap}@font-face{font-family:"Rebond";src:url(chrome-extension://emalgedpdlghbkikiaeocoblajamonoh/fonts/Rebond/rebond-700.woff) format("woff"),url(chrome-extension://emalgedpdlghbkikiaeocoblajamonoh/fonts/Rebond/rebond-700.woff2) format("woff2"),url(chrome-extension://emalgedpdlghbkikiaeocoblajamonoh/fonts/Rebond/rebond-700.ttf) format("truetype");font-style:normal;font-weight:700;font-display:swap}</style><style type="text/css">#j_c_asin div:empty {
          display: block !important;
        }86660#__wikibuy__ .__wikibuy.__onTop,body~div:not(#gdx-bubble-host),#piggyWrapper,#honeyContainer,#earny-root{position:absolute !important;z-index:100000 !important}body[data-shop-url="https://www.honeybum.com"] header>.header{z-index:99999}.mm-slideout{z-index:initial}.sorry-for-this__empty-styles{position:relative;z-index:10000}</style><div style="all: initial;"></div></div><div aria-live="assertive" role="log" aria-relevant="additions" aria-atomic="true" style="position: absolute; width: 1px; height: 1px; margin-top: -1px; clip: rect(1px, 1px, 1px, 1px); overflow: hidden;"></div><div aria-live="assertive" role="log" aria-relevant="additions" aria-atomic="true" style="position: absolute; width: 1px; height: 1px; margin-top: -1px; clip: rect(1px, 1px, 1px, 1px); overflow: hidden;"></div><div style="position: absolute; width: 0px; height: 0px; overflow: hidden; padding: 0px; border: 0px; margin: 0px;"><div id="MathJax_Font_Test" style="position: absolute; visibility: hidden; top: 0px; left: 0px; width: auto; min-width: 0px; max-width: none; padding: 0px; border: 0px; margin: 0px; white-space: nowrap; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; font-size: 40px; font-weight: normal; font-style: normal; font-family: MathJax_Math-italic, sans-serif;"></div></div></body></html>